<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layouts/nolayout">
<th:block layout:fragment="html">
    <div class="contentRoot">
        <div class="content-header">
            <h2>배포요청 관리</h2>
            <div class="button-group">
                <!--등록-->
                <button id="insert-dialog-btn" class="mdc-button mdc-button--outlined mdc-ripple-upgraded">
                    <span class="mdc-button__ripple"></span>
                    <i class="material-icons mdc-button__icon me-1">add</i>
                    <span class="mdc-button__label">등록</span>
                </button>
            </div>
        </div>
        <div class="content-body">
            <div class="card">
                <div class="card-header pb-4">
                    <div class="form-row md-size multiline-align-top">
                        <!-- >> 상태 검색 -->
                        <div class="mdc-select mdc-select--outlined mdc-select--no-label" id="status-mdc-select">
                            <div class="mdc-select__anchor">
                                <div class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label">상태</label>
                                    </div>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </div>
                                <span class="mdc-select__selected-text-container overflow-hidden">
                                    <span class="mdc-select__selected-text"></span>
                                </span>
                                <span class="mdc-select__dropdown-icon"></span>
                            </div>

                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                <ul class="mdc-deprecated-list">
                                    <li class="mdc-deprecated-list-item" data-value="''"
                                        @click="searchCondition.status=''"
                                        :class="{'mdc-deprecated-list-item--selected': searchCondition.status==''}"
                                        :aria-selected="searchCondition.status=='' ? 'true' : 'false'">
                                        <span class="mdc-deprecated-list-item__ripple"></span>
                                        <span class="mdc-deprecated-list-item__text">전체</span>
                                    </li>
                                    <li v-for="status in statuses" class="mdc-deprecated-list-item"
                                        :data-value="status.key"
                                        @click="searchCondition.status = status.key"
                                        :class="{'mdc-deprecated-list-item--selected': searchCondition.status == status.key} "
                                        :aria-selected="searchCondition.status == status.key ? 'true' : 'false'">

                                        <span class="mdc-deprecated-list-item__ripple"></span>
                                        <span class="mdc-deprecated-list-item__text">{{ status.value }}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- << 상태 검색 -->

                        <!-- >> 서비스 모델 검색 -->
                        <div class="mdc-select mdc-select--outlined mdc-select--no-label"
                             id="serviceModels-mdc-select">
                            <div class="mdc-select__anchor">
                                <div class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label">서비스 모델</label>
                                    </div>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </div>
                                <span class="mdc-select__selected-text-container overflow-hidden">
                                    <span class="mdc-select__selected-text"></span>
                                </span>
                                <span class="mdc-select__dropdown-icon"></span>
                            </div>

                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                <ul class="mdc-deprecated-list">
                                    <li class="mdc-deprecated-list-item" data-value="''"
                                        @click="searchCondition.serviceModelId=''"
                                        :class="{'mdc-deprecated-list-item--selected': searchCondition.serviceModelId==''}"
                                        :aria-selected="searchCondition.serviceModelId=='' ? 'true' : 'false'">
                                        <span class="mdc-deprecated-list-item__ripple"></span>
                                        <span class="mdc-deprecated-list-item__text">전체</span>
                                    </li>
                                    <li v-for="serviceModel in serviceModelList" class="mdc-deprecated-list-item"
                                        :data-value="serviceModel.serviceCode"
                                        @click="searchCondition.serviceModelId = serviceModel.serviceCode"
                                        :class="{'mdc-deprecated-list-item--selected': searchCondition.serviceModelId == serviceModel.serviceCode} "
                                        :aria-selected="searchCondition.serviceModelId == serviceModel.serviceCode ? 'true' : 'false'">

                                        <span class="mdc-deprecated-list-item__ripple"></span>
                                        <span
                                          class="mdc-deprecated-list-item__text">{{ serviceModel.serviceModelName }}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- << 서비스 모델 검색 -->

                        <!-- << 작성자 검색 -->
                        <div class="mdc-text-field text-field mdc-text-field--outlined flex-auto search-bar">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text"
                                   v-model="searchCondition.createdBy"/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">작성자</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                        <!-- << 작성자 검색 -->

                      <!-- << 설명 검색 -->
                      <div class="mdc-text-field text-field mdc-text-field--outlined flex-auto search-bar">
                        <input type="text" class="mdc-text-field__input"
                               aria-describedby="text-field-outlined-shape-one-helper-text"
                               v-model="searchCondition.description"/>
                        <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                          <div class="mdc-notched-outline__leading"></div>
                          <div class="mdc-notched-outline__notch">
                            <label class="mdc-floating-label">설명</label>
                          </div>
                          <div class="mdc-notched-outline__trailing"></div>
                        </div>
                      </div>
                      <!-- << 설명 검색 -->

                        <!-- >> 배포일 검색 -->
                        <div class="flex-auto flex-ratio-two">
                            <div class="form-row h-100">
                                <div id="train-start-date-mdc"
                                     class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
                                    <i class="material-icons mdc-text-field__icon">event</i>
                                    <input type="text" class="mdc-text-field__input"
                                           aria-describedby="text-field-outlined-shape-one-helper-text"/>
                                    <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">배포일(from)</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div id="train-end-date-mdc"
                                     class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
                                    <i class="material-icons mdc-text-field__icon">event</i>
                                    <input type="text" class="mdc-text-field__input"
                                           aria-describedby="text-field-outlined-shape-one-helper-text"/>
                                    <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">배포일(to)</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="mdc-text-field-helper-line">
                                <p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg">
                                    배포일이 없는 경우는 전체 기간을 뜻합니다.
                                </p>
                            </div>
                        </div>
                        <!-- << 배포일 검색 -->

                        <!-- << 검색 버튼 -->
                        <button @click="search(true)" class="mdc-button mdc-button--unelevated mdc-ripple-upgraded">
                            <span class="mdc-button__ripple"></span>
                            <i class="material-icons mdc-button__icon me-1">search</i>
                            <span class="mdc-button__label">검색</span>
                        </button>
                        <!-- << 검색 버튼 -->
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-controls form-row md-size">
                        <!--검색 결과-->
                        <div class="table-result-info flex-auto">
                            <h4>검색결과 : <span>{{ pageInfo.total }}</span>건</h4>
                        </div>

                        <!-- >>> 페이지 사이즈 조절 -->
                        <div class="mdc-select mdc-select--outlined mdc-select--no-label">
                            <div class="mdc-select__anchor">
                                <div class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label">레코드 수</label>
                                    </div>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </div>
                                <span class="mdc-select__selected-text-container overflow-hidden">
                        <span class="mdc-select__selected-text"></span>
                </span>
                                <span class="mdc-select__dropdown-icon"></span>
                            </div>
                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                <ul class="mdc-deprecated-list">
                                    <li v-for="ps in pageSizes" class="mdc-deprecated-list-item"
                                        :data-value="ps"
                                        @click="searchCondition.pageSize = ps; currentPage = 1; search();"
                                        :class="{'mdc-deprecated-list-item--selected': searchCondition.pageSize == ps} "
                                        :aria-selected="searchCondition.pageSize == ps ? 'true' : 'false'">
                                        <span class="mdc-deprecated-list-item__ripple"></span>
                                        <span class="mdc-deprecated-list-item__text">{{ ps }}개</span>
                                    </li>

                                </ul>
                            </div>
                        </div>
                        <!-- <<< 페이지 사이즈 조절 -->
                    </div>
                    <!-- 목록 테이블 -->
                    <div class="table-container">
                        <div class="mdc-data-table">
                            <div class="mdc-data-table__table-container">
                                <table class="mdc-data-table__table">
                                    <thead>
                                    <tr>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            No.
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            서비스모델
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            모델타입
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            모델 ID
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            설명
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            작성자
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            배포일시
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            상태조회
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            상태
                                        </th>
                                        <th class="mdc-data-table__header-cell text-center" role="columnheader"
                                            scope="col">
                                            재배포
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody class="mdc-data-table__content">
                                    <tr v-if="searchResults.length == 0" class="mdc-data-table__row"
                                        aria-selected="false"
                                        style="cursor: pointer;">
                                        <td class="mdc-data-table__cell text-center" colspan="9">검색된 결과가 없습니다.</td>
                                    </tr>
                                    <tr v-else v-for="(row, i) in searchResults"
                                        :id="'row-' + row.id"
                                        class="detail-service-row mdc-data-table__row"
                                        aria-selected="false" style="cursor: pointer;">
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ pageInfo.total - ( (currentPage - 1) * searchCondition.pageSize + i) }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ convertServiceModelId2Name(row.serviceModelId) }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ row.resultModelModeltype }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ row.resultModelId }}
                                        </td>
                                        <td class="mdc-data-table__cell"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ row.description }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ row.createdBy }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            {{ row.requestedAt }}
                                        </td>
                                        <td class="mdc-data-table__cell text-center">
                                            <div class="sync-btn-outer">
                                                <button v-if="row.status == 'DEPLOYING'"
                                                        class="up-priority-btn mdc-icon-button material-icons mdc-ripple-upgraded--unbounded mdc-ripple-upgraded  mdc-theme--primary"
                                                        @click="() => status(row.id)">
                                                    sync
                                                </button>
                                                <button v-else
                                                        class="up-priority-btn mdc-icon-button material-icons mdc-ripple-upgraded--unbounded mdc-ripple-upgraded"
                                                        style="color: #ccc;"
                                                        disabled>
                                                    sync
                                                </button>
                                            </div>
                                        </td>
                                        <td class="mdc-data-table__cell text-center"
                                            @click="() => openDetailDialog(row.id)">
                                            <span :id="'status' + row.id">{{ row.status }}</span>
                                        </td>
                                        <td class="mdc-data-table__cell text-center">
                                            <button v-if="row.status == 'READY' || row.status == 'DEPLOYING'"
                                                    class="mdc-button mdc-button--icon-leading mdc-theme--text-disabled-on-light"
                                                    disabled>
                                                <span class="mdc-button__ripple"></span>
                                                <span class="mdc-button__focus-ring"></span>
                                                <!--                            <i class="material-icons mdc-button__icon" aria-hidden="true">backup</i>-->
                                                <span class="mdc-button__label">재배포</span>
                                            </button>
                                            <button v-else class="mdc-button mdc-button--icon-leading"
                                                    @click="() => openUpdateDialog(row.serviceModelId, row.resultModelId)">
                                                <span class="mdc-button__ripple"></span>
                                                <span class="mdc-button__focus-ring"></span>
                                                <!--                            <i class="material-icons mdc-button__icon" aria-hidden="true">backup</i>-->
                                                <span class="mdc-button__label">재배포</span>
                                            </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- pagination -->
                    <div class="table-pagination mdc-data-table__pagination">
                        <div class="mdc-data-table__pagination-trailing mdc-chip-set mdc-chip-set--choice">
                            <div class="mdc-data-table__pagination-navigation">
                                <button
                                  class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                                  data-first-page="true" @click="gotoPage(1)">
                                    <div class="mdc-button__icon">first_page</div>
                                </button>
                                <button
                                  class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                                  data-prev-page="true" @click="gotoPage(currentPage - 1)">
                                    <div class="mdc-button__icon">chevron_left</div>
                                </button>

                                <button v-for="(paging, index) in pages"
                                        class="mdc-chip mdc-data-table__pagination-button fs-6 bg-transparent"
                                        :class="{ 'mdc-chip--selected' : paging == currentPage }"
                                        @click="gotoPage(paging)">
                                    {{ paging }}
                                </button>
                                <button
                                  class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                                  data-next-page="true" @click="gotoPage(currentPage + 1)">
                                    <div class="mdc-button__icon">chevron_right</div>
                                </button>
                                <button
                                  class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                                  data-last-page="true" @click="gotoPage(pageInfo.pages)">
                                    <div class="mdc-button__icon">last_page</div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- >>> 등록 팝업 -->
    <div id="insert-dialog" class="mdc-dialog" role="alertdialog" aria-modal="true"
         aria-labelledby="simple-dialog-label" aria-describedby="simple-dialog-description" tabindex="-1">
        <div class="mdc-dialog__scrim"></div>
        <div class="mdc-dialog__container">
            <div class="mdc-dialog__surface">
                <div class="mdc-dialog__header">
                    <h2 class="mdc-dialog__title">배포 등록</h2>
                    <button class="mdc-icon-button material-icons close-button" tabindex="-1">
                        close
                    </button>
                </div>
                <!-- loading bar -->
                <div id="insert-deploy-dialog-loadingbar" role="progressbar"
                     class="mdc-linear-progress mdc-linear-progress--indeterminate" hidden>
                    <div class="mdc-linear-progress__buffering-dots"></div>
                    <div class="mdc-linear-progress__buffer"></div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                        <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                        <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                </div>
                <section class="mdc-dialog__content form-row-stack">
                    <p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-theme--error">
                        * 표시 항목은 필수입력사항입니다.
                    </p>

                    <!-- 서비스 모델 -->
                    <div class="form-row">
                        <div class="mdc-select mdc-select--outlined mdc-select--no-label mdc-select--required w-100"
                             id="insert-serviceModel-mdc-select">
                            <div class="mdc-select__anchor" aria-required="true">
                                <div class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label mdc-floating-label--required">서비스 모델</label>
                                    </div>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </div>
                                <span class="mdc-select__selected-text-container overflow-hidden">
                                    <span class="mdc-select__selected-text"></span>
                                </span>
                                <span class="mdc-select__dropdown-icon"></span>
                            </div>
                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                <ul class="mdc-deprecated-list">
                                    <!--dynamic data-->
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 모델 ID -->
                    <div class="form-row">
                        <div class="mdc-select mdc-select--outlined mdc-select--no-label mdc-select--required w-100"
                             id="insert-resultModelId-mdc-select">
                            <div class="mdc-select__anchor" aria-required="true">
                                <div class="mdc-notched-outline">
                                    <span class="mdc-notched-outline__leading"></span>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label mdc-floating-label--required">모델 ID</label>
                                    </div>
                                    <span class="mdc-notched-outline__trailing"></span>
                                </div>
                                <span class="mdc-select__selected-text-container overflow-hidden">
                                    <span class="mdc-select__selected-text"></span>
                                </span>
                                <span class="mdc-select__dropdown-icon"></span>
                            </div>
                            <div class="mdc-menu-surface--fixed" style="z-index: 9999;">
                                <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                    <ul class="mdc-deprecated-list">
                                        <!--dynamic data-->
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 등록팝업 모델타입 -->
                    <div class="form-row mdc-form-field">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="insert-resultModel-modeltype"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 타입</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 모델 설명 -->
                    <div class="form-row mdc-form-field">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="insert-resultModel-description"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 설명</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 배포서버 -->
                    <div class="form-row multiline-align-top">
                        <div>
                            <h4 class="mb-1">배포대상 서버선택</h4>
                            <div class="mdc-form-field">
                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio" id="radio-insert-deployTarget"
                                           name="deployType" checked value="insert-deployTarget">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                    <div class="mdc-radio__focus-ring"></div>
                                </div>
                                <label for="radio-insert-deployTarget">기본</label>

                                <div class="mdc-radio">
                                    <input class="mdc-radio__native-control" type="radio"
                                           id="radio-insert-deployTargetSub"
                                           name="deployType" value="insert-deployTargetSub">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                    <div class="mdc-radio__focus-ring"></div>
                                </div>
                                <label for="radio-insert-deployTargetSub">유저선택</label>
                            </div>
                        </div>
                    </div>

                    <!--설명-->
                    <div class="form-row multiline-align-top">
                        <div class="flex-auto">
                            <div class="mdc-text-field text-field mdc-text-field--outlined w-100">
                                <input type="text" class="mdc-text-field__input"
                                       aria-describedby="text-field-outlined-shape-one-helper-text"
                                       id="insert-description-input"/>
                                <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                    <div class="mdc-notched-outline__leading"></div>
                                    <div class="mdc-notched-outline__notch">
                                        <label class="mdc-floating-label">설명</label>
                                    </div>
                                    <div class="mdc-notched-outline__trailing"></div>
                                </div>
                            </div>
                            <div class="mdc-text-field-helper-line" id="insert-description-helper-line">
                            </div>
                        </div>
                    </div>
                </section>
                <footer class="mdc-dialog__actions">
                    <button id="insert-btn" class="mdc-button mdc-button--unelevated mdc-ripple-upgraded">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">배포</span>
                    </button>
                    <button class="mdc-button mdc-button--unelevated mdc-ripple-upgraded mdc-theme--on-default mdc-theme--default-bg close-button">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">취소</span>
                    </button>
                </footer>
            </div>
        </div>
    </div>
    <!-- <<< 등록 팝업 -->

    <!-- >>> 재배포 팝업 -->
    <div id="update-dialog" class="mdc-dialog" role="alertdialog" aria-modal="true"
         aria-labelledby="simple-dialog-label" aria-describedby="simple-dialog-description" tabindex="-1">
        <div class="mdc-dialog__scrim"></div>
        <div class="mdc-dialog__container">
            <div class="mdc-dialog__surface">
                <div class="mdc-dialog__header">
                    <h2 class="mdc-dialog__title">재배포 등록</h2>
                    <button class="mdc-icon-button material-icons close-button" tabindex="-1">
                        close
                    </button>
                </div>
                <!-- loading bar -->
                <div id="re-insert-deploy-dialog-loadingbar" role="progressbar"
                     class="mdc-linear-progress mdc-linear-progress--indeterminate" hidden>
                    <div class="mdc-linear-progress__buffering-dots"></div>
                    <div class="mdc-linear-progress__buffer"></div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                        <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                    <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                        <span class="mdc-linear-progress__bar-inner"></span>
                    </div>
                </div>
                <section class="mdc-dialog__content form-row-stack">
                    <p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-theme--error">
                        * 표시 항목은 필수입력사항입니다.
                    </p>
                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="update-service-model"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">서비스 모델</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 재배포팝업 모델 ID -->
                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="update-resultModelId"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 ID</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 재배포팝업 모델 타입 -->
                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="update-resultModel-modeltype"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 타입</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 재배포팝업 모델 설명 -->
                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="update-resultModel-description"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 설명</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 재배포팝업 배포서버 -->
                    <div class="form-row multiline-align-top">
                        <div>
                            <h4 class="mb-1">배포대상 서버선택</h4>
                            <div class="mdc-form-field">
                                <div class="mdc-radio">
                                    <input id="radio-update-deployTarget" name="updateDeployType" checked
                                           value="update-deployTarget" class="mdc-radio__native-control" type="radio">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                    <div class="mdc-radio__focus-ring"></div>
                                </div>
                                <label for="radio-update-deployTarget">기본</label>

                                <div class="mdc-radio">
                                    <input id="radio-update-deployTargetSub" name="updateDeployType"
                                           value="update-deployTargetSub" class="mdc-radio__native-control"
                                           type="radio">
                                    <div class="mdc-radio__background">
                                        <div class="mdc-radio__outer-circle"></div>
                                        <div class="mdc-radio__inner-circle"></div>
                                    </div>
                                    <div class="mdc-radio__ripple"></div>
                                    <div class="mdc-radio__focus-ring"></div>
                                </div>
                                <label for="radio-update-deployTargetSub">유저선택</label>
                            </div>
                        </div>
                    </div>

                    <!-- 재배포팝업 설명-->
                    <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                        <div class="sample mdc-layout-grid__inner ">
                            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                                <div class="mdc-text-field text-field mdc-text-field--outlined w-100">
                                    <input type="text" class="mdc-text-field__input"
                                           aria-describedby="text-field-outlined-shape-one-helper-text"
                                           id="update-description-input"
                                    />
                                    <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                        <div class="mdc-notched-outline__leading"></div>
                                        <div class="mdc-notched-outline__notch">
                                            <label class="mdc-floating-label">설명</label>
                                        </div>
                                        <div class="mdc-notched-outline__trailing"></div>
                                    </div>
                                </div>
                                <div class="mdc-text-field-helper-line" id="update-description-helper-line">
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <footer class="mdc-dialog__actions">
                    <button id="update-btn" class="mdc-button mdc-button--unelevated mdc-ripple-upgraded">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">재배포</span>
                    </button>
                    <button class="mdc-button mdc-button--unelevated mdc-ripple-upgraded mdc-theme--on-default mdc-theme--default-bg close-button">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">취소</span>
                    </button>
                </footer>
            </div>
        </div>
    </div>
    <!-- <<< 재배포 팝업 -->

    <!-- >>> 상세 팝업 -->
    <div id="detail-dialog" class="mdc-dialog mdc-dialog--scrollable" role="alertdialog" aria-modal="true"
         aria-labelledby="simple-dialog-label" aria-describedby="simple-dialog-description">
        <div class="mdc-dialog__scrim"></div>
        <div class="mdc-dialog__container">
            <div class="mdc-dialog__surface">
                <div class="mdc-dialog__header">
                    <h2 class="mdc-dialog__title">배포 상세</h2>
                    <button class="mdc-icon-button material-icons close-button" data-mdc-dialog-action="close" tabindex="-1">
                        close
                    </button>
                </div>

                <section class="mdc-dialog__content form-row-stack">
                    <p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-theme--error">
                        *모든 항목은 필수입력사항입니다.
                    </p>
                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-service-model"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">서비스 모델</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-result-model-id"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 ID</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-result-model-id-modeltype"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 타입</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-result-model-id-description"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">모델 설명</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-description"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">설명</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-created-by"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">작성자</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-requested-at"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">요청 시간</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-completed-at"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">종료 시간</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-duration"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">소요 시간</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-status"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">상태</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="mdc-text-field text-field mdc-text-field--outlined w-100 ">
                            <input type="text" class="mdc-text-field__input"
                                   aria-describedby="text-field-outlined-shape-one-helper-text" readonly required
                                   id="detail-result-msg"
                                   value=""/>
                            <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                                <div class="mdc-notched-outline__leading"></div>
                                <div class="mdc-notched-outline__notch">
                                    <label class="mdc-floating-label">실패 원인</label>
                                </div>
                                <div class="mdc-notched-outline__trailing"></div>
                            </div>
                        </div>
                    </div>
                </section>
                <footer class="mdc-dialog__actions">
                    <button
                      class="mdc-button mdc-button--unelevated mdc-ripple-upgraded mdc-theme--on-default mdc-theme--default-bg dialog-close-btn"
                      data-mdc-dialog-action="close">
                        <span class="mdc-button__ripple"></span>
                        <span class="mdc-button__label">닫기</span>
                    </button>
                </footer>
            </div>
        </div>
    </div>
    <!-- <<< 상세 팝업 -->

    <input type="hidden" readonly id="smpServiceUriPrefix" th:value="${smpServiceUriPrefix}">
    <input type="hidden" readonly id="resultModel2Description" th:value="${resultModelId2Descriptions}">
    <input type="hidden" readonly id="resultModel2Modeltype" th:value="${resultModelId2ModelTypes}">
    <input type="hidden" readonly id="serviceCode2ResultModelIds" th:value="${serviceCode2ResultModelIds}">
    <input type="hidden" readonly id="defaultPageSize" th:value="${defaultPageSize}">
</th:block>

<th:block layout:fragment="script">
    <script type="text/javascript">
        (function () {
            var LABEL = {
                searchCondition: {
                    serviceModelId: "",
                    createdBy: "",
                    description : "",
                    status: "",
                    from: "",
                    to: "",
                    pageSize: $("#defaultPageSize").val()
                },
                detailObj: {
                    serviceModelId: "",
                    resultModelId: "",
                    resultModelDescription: "",
                    resultModelModeltype: "",
                    description: "",
                    createdBy: "",
                    requestedAt: "",
                    completedAt: "",
                    duration: "",
                    status: "",
                    resultMsg: ""
                },
                insertRequest: {
                    serviceModelId: "",
                    resultModelId: "",
                    resultModelDescription: "",
                    resultModelModeltype: "",
                    description: "",
                    deployTargetServer:""
                },
                statuses: [
                    {key: "READY", value: "미배포 상태"},
                    {key: "DEPLOYING", value: "배포 중"},
                    {key: "COMPLETE", value: "배포 완료"},
                    {key: "FAIL", value: "배포 실패"}
                ]
            };
            new Vue({
                el: ".contentRoot",
                data: {
                    // 팝업
                    insertDialog: mdc.dialog.MDCDialog.attachTo(document.querySelector('#insert-dialog')),
                    updateDialog: mdc.dialog.MDCDialog.attachTo(document.querySelector('#update-dialog')),
                    detailDialog: mdc.dialog.MDCDialog.attachTo(document.querySelector('#detail-dialog')),
                    insertDialogLoadingBar: $("#insert-deploy-dialog-loadingbar"),
                    updateDialogLoadingBar: $("#re-insert-deploy-dialog-loadingbar"),
                    // 검색
                    searchCondition: {...LABEL.searchCondition},
                    searching: false,
                    searchResults: [],

                    // pagination
                    pageSizes: [10, 20, 30, 40, 50],
                    currentPage: 1,
                    pageInfo: {
                        pages: 1,
                        total: 1
                    },
                    pageNumLists: [1],
                    /*page: {
                        pageNum: 1,
                        pageSize: 10,
                        orderBy: 'REG_DT DESC'
                    },*/

                    // 검색 조건
                    serviceModelList: JSON.parse("[[${serviceModelList}]]".replaceAll('&quot;', "\"")),
                    statuses: [],
                    newObj: {...LABEL.insertRequest},
                    detailObj: {...LABEL.detailObj},
                    SERVICE_MODEL_ID_TO_CODE: {},
                    SERVICE_MODEL_ID_TO_NAME: {},
                    SERVICE_MODEL_NAME_TO_ID: {},
                    RESULT_MODEL_ID_TO_DESCRIPTIONS: {},
                    RESULT_MODEL_ID_TO_MODELTYPES: {},

                    deployTargetList: [
                        {key: "기본" , value:""},
                        {key: "유저선택" , value: ""}
                    ],
                    deployTargetList2: [
                        {key: "SERVER1" , value:"SERVER1"},
                        {key: "SERVER2" , value: "SERVER2"}
                    ],
                    deployType: "insert-deployTarget",
                    updateDeployType: "update-deployTarget",

                    // constant
                    DESCRIPTION_MAX_LENGTH: 255,

                    // etc
                    currentXhr: [],		// 모달 내 XHR 중단할 때 사용
                    checkXhrAbort: false,	// 모달 내에서 등록/저장 등 업로드 시엔 컨펌 추가
                    currentDialog: null     // vue data에서 정의한 모달의 key. ( :string)
                },
                computed: {
                    pages: function () {
                        const list = [];
                        for (let index = this.startPage; index <= this.endPage; index += 1) {
                            list.push(index);
                        }
                        return list;
                    },
                    startPage() {
                        return parseInt((this.currentPage - 1) / 5) * 5 + 1;
                    },
                    endPage() {
                        var lastPage = parseInt((this.currentPage - 1) / 5 + 1) * 5;
                        return lastPage <= this.pageInfo.pages ? lastPage : this.pageInfo.pages;
                    }
                },
                created: function () {
                    // Base url 받아오기
                    const baseUrl = document.querySelector('#smpServiceUriPrefix').value;
                    this.baseUrl = baseUrl;

                    // 데이터 구분 목록 받아오기
                    var self = this;

                    this.initDeployTarget()

                    this.initServiceModel()

                    this.initStatus(() => {

                        self.$nextTick(function () {
                            const $select = $("#status-mdc-select")[0];
                            $($select).data('instance').destroy();

                            const newMdcSelect = new mdc.select.MDCSelect($select);
                            $($select).data('instance', newMdcSelect);
                        })
                    })

                    this.initResultModelId2Descriptions();

                    this.initResultModelId2Modeltypes();

                    this.search();
                },
                mounted: function () {

                    // 페이지 이동시 처리
                    $('#drawer-main-content-viewer').one('page.move', function () {

                        // MaterialDatepicker가 화면을 종료해도 자동으로 종료되지 않아 이벤트 unbinding 추가
                        var $trainStartDateMdc = $('#train-start-date-mdc');
                        var $trainEndDateMdc = $('#train-end-date-mdc');
                        $trainStartDateMdc.data('datepicker').destroy();
                        $trainEndDateMdc.data('datepicker').destroy();
                    });

                    this.initMaterialUx();
                    this.initSearchBarEvents();
                    var self = this;

                    // >>> 등록 dialog 설정
                    var insertDialog = this.insertDialog;

                    /*$('#insert-dialog-btn').off('click').on('click', function () {
                      insertDialog.open();
                    });*/

                    insertDialog.listen('MDCDialog:opening', function () {

                        // 화면 및 데이터 초기화
                        self.initializeInsertDialog();

                        // component 이벤트 등록
                        $("#insert-serviceModel-mdc-select").off('MDCSelect:change').on('MDCSelect:change', self.onChangeInsertServiceModel)
                        $('#insert-resultModelId-mdc-select').off('MDCSelect:change').on('MDCSelect:change', self.onChangeResultModelId)
                        $("#insert-description-input").off('keyup').on('keyup', self.onChangeInsertDescription)
                        $("#insert-dialog input[type=radio]").off('click').on('click', self.onChangeInsertDeployType)

                        $("#insert-btn").off('click').on('click', self.insert)
                    });
                    insertDialog.listen('MDCDialog:closed', function () {
                        self.deployType = 'insert-deployTarget';
                    });

                    $('#insert-dialog-btn').off('click').on('click', function () {
                        self.insertDialog.open();
                        self.currentDialog = 'insertDialog';
                    });
                    // <<< 등록 dialog 설정

                    // >>> 재배포 dialog 설정
                    var updateDialog = this.updateDialog;

                    updateDialog.listen('MDCDialog:opening', function () {

                        // 화면 및 데이터 초기화
                        self.initializeUpdateDialog();

                        // component 이벤트 등록
                        $("#update-description-input").off('keyup').on('keyup', self.onChangeUpdateDialogDescription)
                        $("#update-dialog input[type=radio]").off('click').on('click', self.onChangeUpdateDeployType)

                        $("#update-btn").off('click').on('click', self.update)
                    });
                    updateDialog.listen('MDCDialog:closed', function () {
                        self.updateDeployType = 'update-deployTarget';
                    });

                    // <<<  dialog 설정

                    // >>> 상세 dialog 설정
                    var detailDialog = this.detailDialog;
                    detailDialog.listen('MDCDialog:opening', function () {
                        // 화면 및 데이터 초기화
                        self.initializeDetailDialog();
                    });
                    // <<< 상세 dialog 설정

                    // 모달 닫기 및 xhr 종료 이벤트 바인딩
                    $('.close-button').off('click').on('click', function () {
                        self.onCloseDialog();
                    })
                    $('.mdc-dialog').on('keydown', function (e) {
                        if (e.key === 'Escape') self.onCloseDialog();
                    })
                },
                methods: {
                    initMaterialUx: function () {
                        // ripple material ux 적용
                        const elements = document.querySelectorAll('.mdc-ripple-upgraded');
                        for (const el of elements) {
                            el.class
                            mdc.ripple.MDCRipple.attachTo(el, el.classList.contains('mdc-ripple-upgraded--unbounded') ? {
                                isUnbounded: true
                            } : void 0);
                        }

                        // input text material ux 적용
                        const textFields = document.querySelectorAll('.mdc-text-field');
                        for (const textField of textFields) {
                            const mdcTextField = mdc.textField.MDCTextField.attachTo(textField);
                            $(textField).data('instance', mdcTextField);
                        }

                        // select material ux 적용
                        const selects = document.querySelectorAll('.mdc-select');
                        for (const el of selects) {
                            const select = mdc.select.MDCSelect.attachTo(el);
                            $(el).data('instance', select); //
                        }

                        // linear progress material ux 적용
                        const progresses = document.querySelectorAll('.mdc-linear-progress');
                        for (const el of progresses) {
                            const progress = mdc.linearProgress.MDCLinearProgress.attachTo(el);
                            $(el).data('instance', progress); //
                        }

                        // dialog에 close 이벤트 주는 방법: escape key, dialog 외부 클릭 막기.
                        this.insertDialog.scrimClickAction = "";
                        this.detailDialog.scrimClickAction = "";

                        this.initMaterialDatepickers();
                    },

                    initResultModelId2Descriptions: function () {
                        var list = JSON.parse(document.querySelector('#resultModel2Description').value);

                        for (var i = 0; i < list.length; i++) {
                            var key = list[i].key;
                            var value = list[i].value;

                            this.RESULT_MODEL_ID_TO_DESCRIPTIONS[key] = value;
                        }
                    },

                    initResultModelId2Modeltypes: function () {
                        var list = JSON.parse(document.querySelector('#resultModel2Modeltype').value);

                        for (var i = 0; i < list.length; i++) {
                            var key = list[i].key;
                            var value = list[i].value;

                            this.RESULT_MODEL_ID_TO_MODELTYPES[key] = value;
                        }
                    },

                    initSearchBarEvents: function () {
                        var self = this;
                        $('.search-bar input').on("keydown", function (e) {
                            if (e.keyCode == 13) {
                                self.search();
                            }
                        });
                    },

                    initMaterialDatepickers: function () {

                        // datepicker 적용
                        var self = this;
                        var $trainStartAtInput = $('#train-start-date-mdc');
                        var $trainEndAtInput = $('#train-end-date-mdc');


                        // https://github.com/FreddyFY/material-datepicker
                        var datepickerOption = {
                            lang: "en",
                            orientation: "portrait",
                            color: document.defaultView.getComputedStyle(document.documentElement).getPropertyValue("--mdc-theme-primary"),
                            closeAfterClick: false,
                            outputFormat: 'YYYY-MM-DD',
                            topHeaderFormat: 'YYYY MM',
                            headerFormat: 'Do' // 1st 2nd ... 30th 31st
                        };

                        if ($trainStartAtInput.data('datepicker') != null) {
                            $trainStartAtInput.data('datepicker').destroy();
                        }

                        $trainStartAtInput.data('datepicker', new MaterialDatepicker($trainStartAtInput.data('instance').input, $.extend({}, datepickerOption, {
                            onChange: function (date) {
                                if (_.isEmpty($trainStartAtInput.data('instance').value)) {
                                    self.searchCondition.from = "";
                                } else {
                                    self.searchCondition.from = moment(date).format("YYYY-MM-DD");
                                }
                            }
                        })));

                        if ($trainEndAtInput.data('datepicker') != null) {
                            $trainEndAtInput.data('datepicker').destroy();
                        }

                        $trainEndAtInput.data('datepicker', new MaterialDatepicker($trainEndAtInput.data('instance').input, $.extend({}, datepickerOption, {
                            onChange: function (date) {
                                if (_.isEmpty($trainEndAtInput.data('instance').value)) {
                                    self.searchCondition.to = "";
                                } else {
                                    self.searchCondition.to = moment(date).format("YYYY-MM-DD");
                                }
                            }
                        })));

                        $trainStartAtInput.data('instance').value = '';
                        $trainEndAtInput.data('instance').value = '';
                    },

                    initServiceModel: function () {
                        // insert, select에 서비스 추가
                        var ulHtmlStr = '';
                        ulHtmlStr += `
                            <li class="mdc-deprecated-list-item mdc-deprecated-list-item--selected"
                                aria-selected
                                data-value="0">
                                <span class="mdc-deprecated-list-item__ripple"></span>
                                <span class="mdc-deprecated-list-item__text">"선택"</span>
                            </li>`

                        for (var i = 0; i < this.serviceModelList.length; i++) {
                            var serviceModel = this.serviceModelList[i];

                            var htmlStr = `
                            <li class="mdc-deprecated-list-item"
                                data-value="${serviceModel.serviceCode}">
                                <span class="mdc-deprecated-list-item__ripple"></span>
                                <span class="mdc-deprecated-list-item__text">${serviceModel.serviceModelName}</span>
                            </li>`
                            ulHtmlStr += htmlStr;

                            this.SERVICE_MODEL_ID_TO_NAME[serviceModel.serviceCode] = serviceModel.serviceModelName;
                            this.SERVICE_MODEL_ID_TO_CODE[serviceModel.serviceCode] = serviceModel.serviceCode;
                            this.SERVICE_MODEL_NAME_TO_ID[serviceModel.serviceModelName] = serviceModel.id;
                        }

                        $("#insert-serviceModel-mdc-select ul").html(ulHtmlStr)
                    },
                    // 배포대상 서버 설정값에 있는거 읽어오기
                    initDeployTarget: function () {

                        $.ajax({
                            url: this.baseUrl + "/deploy/api/deployTarget",
                            method: "get",
                            contentType: 'application/json; charset=UTF-8',
                            dataType: "json"

                        }).done(result => {
                            // 자바사이드에서 신규 DTO를 만들어서 리턴을 줘도 된다.

                            //this.deployTargetList = {...result.result};

                            if( result.result.deployTarget === result.result.deployTargetSub ) {
                                this.deployTargetList[0].value = String(result.result.deployTarget);
                                //this.deployTargetList[1].value = String("N/A");
                                this.deployTargetList.pop();

                                $("label[for='radio-insert-deployTarget']").text("학습서버");
                                $("label[for='radio-insert-deployTargetSub']").text("N/A")
                                $("label[for='radio-update-deployTarget']").text("학습서버");
                                $("label[for='radio-update-deployTargetSub']").text("N/A")
                            }else {
                                this.deployTargetList[0].value = String(result.result.deployTarget);
                                this.deployTargetList[1].value = String(result.result.deployTargetSub);

                                $("label[for='radio-insert-deployTarget']").text("학습서버");
                                $("label[for='radio-insert-deployTargetSub']").text("운영서버")
                                $("label[for='radio-update-deployTarget']").text("학습서버");
                                $("label[for='radio-update-deployTargetSub']").text("운영서버")
                            }
                            //console.log(">>>>> [initDeployTarget] deployTargetList setting value : " , this.deployTargetList );

                            // 받은 값 HTML 소스에 넣기

                        });

                    },

                    initStatus: function (callback) {
                        this.statuses = {...LABEL.statuses}

                        callback();
                    },

                    // 검색
                    search: function (isSearchBtnClicked) {
                        this._setSearching(true);

                        var searchConditions = {...this.searchCondition}

                        if (isSearchBtnClicked) {
                            searchConditions['page'] = 1;
                        } else {
                            searchConditions['page'] = this.currentPage;
                        }

                        commonObject.deleteNullOrDefaultFields(searchConditions);
                        var queryString = Qs.stringify(searchConditions);

                        $.ajax({
                            url: this.baseUrl + "/deploy/api/listPage?" + queryString,
                            method: "get",
                            contentType: 'application/json; charset=UTF-8',
                            dataType: "json"
                        }).done(data => {
                            this._setSearchResultsPageInfo(data); // 검색 결과 페이지 정보 저장

                            for(var i=0; i<data.result.length; i++) {
                                data.result[i].isFirst = 0;
                            }
                            if(searchConditions['page'] && searchConditions['page'] == 1 && data.result && data.result.length > 0) {
                                data.result[0].isFirst = 1;
                            }
                            console.log('> ', data.result);
                            this._setSearchResults(data.result); // 검색 결과 목록
                        }).always(() => {
                            this._setSearching(false);
                        })
                    },

                    // 상세
                    detail: function (deployId, callback) {
                        $.ajax({
                            url: this.baseUrl + "/deploy/api/" + deployId,
                            method: "get",
                            contentType: 'application/json; charset=UTF-8',
                            dataType: "json",
                        }).done(result => {
                            this.detailObj = {...result.result};

                            callback();
                        });
                    },

                    // 배포
                    insert: function (e) {
                        //console.log(">>> insert this.deployTargetList : " , this.deployTargetList, this.deployType);
                        //console.log(">>> insert this.newObj.deployTargetServer : ", this.newObj.deployTargetServer);
                        if (!this.validateInsert()) {
                            return;
                        }

                        var newObj = {...this.newObj}
                        var msg = "";
                        var addUri = "";
                        newObj.deployTargetServer = "";
                        if (this.deployType == 'insert-deployTargetSub') {
                            msg ="운영서버의 배포 요청을 하시겠습니까?";
                            //addUri = "/deploy/api/deployMultipart";
                            //this.newObj.deployTargetServer = this.deployTargetList[0].value;
                            newObj.deployTarget = "sub";
                        }else{ // 수협에서는 오른쪽께 멀티파트요청서버임
                            msg = "학습서버의 배포 요청을 하시겠습니까?";
                            //addUri = "/deploy/api/insert";
                            //this.newObj.deployTargetServer = this.deployTargetList[1].value;
                            newObj.deployTarget = "host";
                        }

                        if (confirm(msg)) {
                            this.setDialogLoading(this.insertDialogLoadingBar, true);
                            this.checkXhrAbort = true;
                            this.dispatchProcessing('process');
                            let apiUrl = this.baseUrl + "/deploy/api/insert";
                            var self = this;
                            let xhr = $.ajax({
                                url: apiUrl,
                                method: "post",
                                contentType: 'application/json; charset=UTF-8',
                                dataType: "json",
                                data: JSON.stringify(newObj)
                            }).done(result => {
                                if (result.resultCode == "0000") {
                                    toastr.success(result.resultMsg);
                                    self.insertDialog.close();
                                } else {
                                    toastr.error(result.resultMsg);
                                }
                            }).always(() => {
                                this.setDialogLoading(this.insertDialogLoadingBar, false);
                                this.search();
                                // 배열에서 해당 xhr 제거 및 checkXhrAbort 초기화
                                let result = self.currentXhr.find(obj => obj.id === apiUrl);
                                if (result) {
                                    let index = self.currentXhr.indexOf(result);
                                    self.currentXhr.splice(index, 1);
                                }
                                self.checkXhrAbort = false;
                                self.dispatchProcessing('done');
                            });
                            // abort 적용을 위해 xhr 객체에 id를 추가해 배열에 push
                            let result = {id: apiUrl, xhr};
                            self.currentXhr.push(result);
                        }

                        e.preventDefault();
                        e.stopPropagation();
                    },

                    // 재배포
                    update: function (e) {
                        //console.log(">>> update this.newObj.deployTargetServer : ", this.newObj.deployTargetServer);
                        if (!this.validateUpdate()) {
                            return;
                        }

                        var newObj = {...this.newObj}
                        newObj.deployTargetServer = "";

                        var msg =""
                        var addUri=""
                        if(this.updateDeployType == 'update-deployTargetSub') {
                            msg = "운영서버의 재배포 요청을 하시겠습니까?";
                            //addUri = "/deploy/api/updateMultipart";
                            //this.newObj.deployTargetServer = this.deployTargetList[1].value;
                            newObj.deployTarget = "sub";
                        } else {
                            msg = "학습서버의 재배포 요청을 하시겠습니까?";
                            //addUri = "/deploy/api/update";
                            //this.newObj.deployTargetServer = this.deployTargetList[0].value;
                            newObj.deployTarget = "host";
                        }

                        // abort 적용할 대상엔 true로 설정
                        this.checkXhrAbort = true;
                        let apiUrl = this.baseUrl + "/deploy/api/update";

                        if (confirm(msg)) {
                            this.setDialogLoading(this.updateDialogLoadingBar, true);
                            this.dispatchProcessing('process');
                            var self = this;
                            let xhr = $.ajax({
                                url: apiUrl,
                                method: "post",
                                contentType: 'application/json; charset=UTF-8',
                                dataType: "json",
                                data: JSON.stringify(newObj)
                            }).done(result => {
                                if (result.resultCode == "0000") {
                                    toastr.success(result.resultMsg);
                                    self.updateDialog.close();
                                } else {
                                    toastr.error(result.resultMsg);
                                }
                            }).always(() => {
                                this.setDialogLoading(this.updateDialogLoadingBar, false);
                                self.search(true);
                                // 배열에서 해당 xhr 제거 및 checkXhrAbort 초기화
                                let result = self.currentXhr.find(obj => obj.id === apiUrl);
                                if (result) {
                                    let index = self.currentXhr.indexOf(result);
                                    self.currentXhr.splice(index, 1);
                                }
                                self.checkXhrAbort = false;
                                self.dispatchProcessing('done');
                            });
                            // abort 적용을 위해 xhr 객체에 id를 추가해 배열에 push
                            let result = {id: apiUrl, xhr};
                            self.currentXhr.push(result);
                        }

                        e.preventDefault();
                        e.stopPropagation();
                    },
                    status: function (deployId) {
                        if (confirm("상태 조회를 하시겠습니까?")) {
                            var self = this;
                            var dd = new Date().getMilliseconds();
                            const $rowEl = $("#row-" + deployId);
                            $rowEl.addClass("synchronizing");

                            $.ajax({
                                url: this.baseUrl + "/deploy/api/status?id=" + deployId + "&dt=" + dd,
                                method: "get",
                                contentType: 'application/json; charset=UTF-8',
                                dataType: "json"
                            }).done(data => {
                                if (data.resultCode !== "0000") {
                                    toastr.error(data.resultMsg);
                                    return;
                                }
                                $("#status" + deployId).animate({'opacity': 0}, 100, function () {
                                    $("#status" + deployId).animate({'opacity': 1}, 300);
                                });
                                let currentRow = self.searchResults.find(row => row.id === deployId);
                                currentRow.status = data.result;
                            }).always(() => {
                                $rowEl.removeClass("synchronizing");
                                $rowEl.addClass("is-done");
                                setTimeout(() => {$rowEl.removeClass("is-done")}, 700)
                            })
                        }
                    },

                    // 배포 팝업 초기화
                    initializeInsertDialog: function () {

                        var $insertServiceModelElement = $("#insert-serviceModel-mdc-select")[0];
                        $($insertServiceModelElement).data('instance').setSelectedIndex(0);

                        $($('#insert-resultModel-description')[0].parentElement).data('instance').value = '';

                        $($('#insert-resultModel-modeltype')[0].parentElement).data('instance').value = '';

                        // 배포서버
                        this.deployType = 'insert-deployTarget';
                        this.newObj.deployTargetServer = this.deployTargetList[0].value;
                        $("#radio-insert-deployTarget").prop("checked", true)

                        // 설명
                        $($('#insert-description-input')[0].parentElement).data('instance').value = '';
                        this._showValidationHelperLine('', $("#insert-description-helper-line"), '설명');


                    },

                    // 재배포 팝업 초기화
                    initializeUpdateDialog: function () {

                        // 설명
                        $($('#update-description-input')[0].parentElement).data('instance').value = '';
                        this._showValidationHelperLine('', $("#update-description-helper-line"), '설명');
                        this.updateDeployType = 'update-deployTarget';
                        this.newObj.deployTargetServer = this.deployTargetList[0].value;
                        $("#radio-update-deployTarget").prop("checked", true)

                    },

                    // 상세 팝업 초기화
                    initializeDetailDialog: function () {

                        // 서비스 모델
                        $($('#detail-service-model')[0].parentElement).data('instance').value = this.convertServiceModelId2Name(this.detailObj.serviceModelId);

                        // 모델 ID
                        $($('#detail-result-model-id')[0].parentElement).data('instance').value = this.convertString(this.detailObj.resultModelId);

                        // 모델 ID 설명
                        $($('#detail-result-model-id-description')[0].parentElement).data('instance').value = this.convertString(this.detailObj.resultModelDescription);

                        // 모델 ID 모델타입
                        $($('#detail-result-model-id-modeltype')[0].parentElement).data('instance').value = this.convertString(this.detailObj.resultModelModeltype);

                        // 설명
                        $($('#detail-description')[0].parentElement).data('instance').value = this.convertString(this.detailObj.description);

                        // 작성자
                        $($('#detail-created-by')[0].parentElement).data('instance').value = this.convertString(this.detailObj.createdBy);

                        // 요청날짜
                        $($('#detail-requested-at')[0].parentElement).data('instance').value = this.convertString(this.detailObj.requestedAt);

                        // 종료날짜
                        $($('#detail-completed-at')[0].parentElement).data('instance').value = this.convertString(this.detailObj.completedAt);

                        // 경과시간
                        $($('#detail-duration')[0].parentElement).data('instance').value = this.convertString(this.detailObj.duration);

                        // 상태
                        $($('#detail-status')[0].parentElement).data('instance').value = this.convertString(this.detailObj.status);

                        // 실패 원인
                        $($('#detail-result-msg')[0].parentElement).data('instance').value = this.convertString(this.detailObj.resultMsg);
                    },

                    // 검색 이벤트
                    initSearchBarEvents: function () {
                        var self = this;
                        $('.search-bar input').on("keydown", function (e) {
                            if (e.keyCode == 13) {
                                self.search(true);
                            }
                        });
                    },

                    _setSearchResults: function (result) {
                        this.searchResults = result;
                    },
                    _setSearchResultsPageInfo: function (data) {
                        this.pageInfo.pages = data.pages;
                        this.pageInfo.total = data.total;
                        this.currentPage = data.pageNum;
                    },
                    _setSearching: function (searching) {
                        this.searching = searching;
                    },

                    // 페이지네이션
                    gotoPage: function (pageNum) {
                        let validPageNum = pageNum;
                        if (pageNum < 1) {
                            validPageNum = 1;
                        } else if (pageNum > this.pageInfo.pages) {
                            validPageNum = this.pageInfo.pages;
                        }

                        this.currentPage = validPageNum;
                        this.search();
                    },

                    // insert 이벤트
                    onChangeInsertServiceModel: function (e) {

                        $($('#insert-resultModel-description')[0].parentElement).data('instance').value = "";
                        $($('#insert-resultModel-modeltype')[0].parentElement).data('instance').value = "";

                        var serviceModelId = $(e.target).data('instance').value;
                        this.newObj.serviceModelId = serviceModelId;

                        var serviceCode2ResultModelIds = JSON.parse(document.querySelector('#serviceCode2ResultModelIds').value);
                        var code = this.SERVICE_MODEL_ID_TO_CODE[serviceModelId];
                        var ulHtmlStr = '';

                        if (serviceCode2ResultModelIds[code] != null) {
                            for (var i = 0; i < serviceCode2ResultModelIds[code].length; i++) {
                                var htmlStr = `
                            <li class="mdc-deprecated-list-item ${i == 0 ? 'mdc-deprecated-list-item--selected' : ''}"
                                ${i == 0 ? 'aria-selected ' : ''}
                                data-value="${serviceCode2ResultModelIds[code][i]}">
                                <span class="mdc-deprecated-list-item__ripple"></span>
                                <span class="mdc-deprecated-list-item__text">${serviceCode2ResultModelIds[code][i]}</span>
                            </li>`
                                ulHtmlStr += htmlStr;
                            }
                        }

                        $("#insert-resultModelId-mdc-select ul").html(ulHtmlStr)

                        const $insertResultModelIdSelect = $("#insert-resultModelId-mdc-select")[0];
                        $($insertResultModelIdSelect).data('instance').destroy();
                        const newInsertMdcSelect = new mdc.select.MDCSelect($insertResultModelIdSelect);
                        $($insertResultModelIdSelect).data('instance', newInsertMdcSelect);

                        if (serviceCode2ResultModelIds[code] != null && serviceCode2ResultModelIds[code].length > 0) {
                            this.newObj.resultModelId = serviceCode2ResultModelIds[code][0];

                            var resultModelIdDesc = this.RESULT_MODEL_ID_TO_DESCRIPTIONS[serviceCode2ResultModelIds[code][0]];
                            if(resultModelIdDesc != null && resultModelIdDesc != undefined){
                                $($('#insert-resultModel-description')[0].parentElement).data('instance').value = resultModelIdDesc;
                                this.newObj.resultModelDescription = resultModelIdDesc;
                            }

                            var resultModelIdModeltype = this.RESULT_MODEL_ID_TO_MODELTYPES[serviceCode2ResultModelIds[code][0]];
                            if(resultModelIdModeltype != null && resultModelIdModeltype != undefined){
                                $($('#insert-resultModel-modeltype')[0].parentElement).data('instance').value = resultModelIdModeltype;
                                this.newObj.resultModelModeltype = resultModelIdModeltype;
                            }

                        }
                    },
                    onChangeInsertDeployTarget: function(e) {

                        this.newObj.deployTargetServer = $(e.target).data('instance').value;

                    },
                    onChangeInsertDeployType: function (e) {
                        this.deployType = e.target.value;
                        //console.log(">>> onChangeInsertDeployType  this.deployTargetList : " , this.deployTargetList, this.deployType);
                        if (this.deployType == 'insert-deployTarget') {

                            //this.newObj.deployTargetServer = this.deployTargetList[0].value;

                        }else if(this.deployType == 'insert-deployTargetSub') {
                            if(this.deployTargetList.length == 1){
                                this.newObj.deployTargetServer = "";
                            }
                            //this.newObj.deployTargetServer = this.deployTargetList[1].value;

                        }
                    },
                    onChangeInsertDescription: function (e) {
                        var newDescription = e.target.value;
                        //e.target.value = newDescription;

                        var $helperLine = $("#insert-description-helper-line")

                        if (this.validateDescription(e.target.value)) {
                            this._showValidationHelperLine("VALID", $helperLine, "설명");
                            this.newObj.description = newDescription;
                        } else {
                            this._showValidationHelperLine("INVALID", $helperLine, "설명");
                            e.target.focus();
                        }
                    },
                    onChangeResultModelId: function (e) {
                        // console.log("> onChangeResultModelId ");
                        var selectedResultModelId = $(e.target).data('instance').value;
                        this.newObj.resultModelId = selectedResultModelId;

                        $($('#insert-resultModel-description')[0].parentElement).data('instance').value  = this.RESULT_MODEL_ID_TO_DESCRIPTIONS[selectedResultModelId];
                        this.newObj.resultModelDescription = this.RESULT_MODEL_ID_TO_DESCRIPTIONS[selectedResultModelId];
                        $($('#insert-resultModel-modeltype')[0].parentElement).data('instance').value  = this.RESULT_MODEL_ID_TO_MODELTYPES[selectedResultModelId];
                        this.newObj.resultModelModeltype = this.RESULT_MODEL_ID_TO_MODELTYPES[selectedResultModelId];

                        // console.log("> this.RESULT_MODEL_ID_TO_DESCRIPTIONS", this.RESULT_MODEL_ID_TO_DESCRIPTIONS);
                    },
                    onChangeUpdateDialogDescription: function (e) {
                        var newDescription = e.target.value.trim();
                        e.target.value = newDescription;

                        var $helperLine = $("#update-description-helper-line")

                        if (this.validateDescription(e.target.value)) {
                            this._showValidationHelperLine("VALID", $helperLine, "설명");
                            this.newObj.description = newDescription;
                        } else {
                            this._showValidationHelperLine("INVALID", $helperLine, "설명");
                            e.target.focus();
                        }
                    },
                    onChangeUpdateDeployType: function (e) {
                        this.updateDeployType = e.target.value;
                        //console.log(">>> onChangeUpdateDeployType  this.deployTargetList : " , this.deployTargetList, this.deployType);
                        if (this.updateDeployType == 'update-deployTargetSub') {
                            if(this.deployTargetList.length == 1){
                                this.newObj.deployTargetServer = "";
                                return;
                            }
                            //this.newObj.deployTargetServer = this.deployTargetList[1].value;
                        }else{
                            //this.newObj.deployTargetServer = this.deployTargetList[0].value;
                        }
                    },
                    _showValidationHelperLine: function (mode, $helperline, key) {
                        if (mode == "VALID") {
                            $helperline.html(
                              `<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg mdc-theme--success">
                                                        사용 가능한 ${key}입니다.
                                                    </p>`
                            )
                        } else if (mode == "INVALID") {
                            $helperline.html(
                              `<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg mdc-theme--error ">
                                                        유효하지 않은 ${key}입니다.
                                                    </p>`
                            )
                        } else {
                            $helperline.html('<p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg "></p>');
                        }
                    },
                    onChangeUpdateDescription: function (e) {
                        var newObj = e.target.value;
                        //e.target.value = newObj;

                        var $helperLine = $("#detail-description-helper-line")

                        if (this.validateDescription(e.target.value)) {
                            this._showValidationHelperLine("", $helperLine, "설명");
                        } else {
                            this._showValidationHelperLine("INVALID", $helperLine, "설명");
                            e.target.focus();
                        }

                        this.detailObj.description = newObj;
                    },

                    // 유효성 검사 (액션별)
                    validateInsert: function () {
                        // 서비스 모델
                        if (this.newObj.serviceModelId == null || this.newObj.serviceModelId == undefined || this.newObj.serviceModelId == 0) {
                            toastr.error("서비스 모델을 선택해주세요.")
                            return;
                        }

                        if (this.newObj.resultModelId == null || this.newObj.resultModelId == undefined || this.newObj.resultModelId == 0) {
                            toastr.error("모델을 선택해주세요.")
                            return;
                        }

                        // 배포대상 서버 선택
//              if(this.newObj.deployTargetServer == null || this.newObj.deployTargetServer == undefined || this.newObj.deployTargetServer == 'N/A'){
//				  toastr.error("배포서버 선택을 다시 해주세요.")
//                 return;
//			  }

                        // 설명
                        if (!this.validateDescription($($("#insert-description-input")[0].parentElement).data('instance').value)) {
                            toastr.error("설명은 최대" + this.DESCRIPTION_MAX_LENGTH + "자 까지 입력 가능합니다.")
                            return;
                        }

                        return true;
                    },

                    validateUpdate: function() {
                        // 설명
                        if (!this.validateDescription($($("#insert-description-input")[0].parentElement).data('instance').value)) {
                            toastr.error("설명은 최대" + this.DESCRIPTION_MAX_LENGTH + "자 까지 입력 가능합니다.")
                            return;
                        }

                        // 배포대상 서버 선택
//              if(this.newObj.deployTargetServer == null || this.newObj.deployTargetServer == undefined || this.newObj.deployTargetServer == 'N/A'){
//				  toastr.error("배포서버 선택을 다시 해주세요.")
//                  return;
//			  }

                        return true;
                    },

                    validateDescription: function (value) {
                        // 최대 글자
                        //var newValue = value;
                        //return newValue.length <= this.DESCRIPTION_MAX_LENGTH;
                        return true;
                    },

                    // 상세 페이지 오픈
                    openDetailDialog: function (deployId) {
                        var self = this;
                        this.detail(deployId, () => self.detailDialog.open());
                    },
                    // 재배포 페이지 오픈
                    openUpdateDialog: function (serviceModelId, resultModelId) {
                        var self = this;
                        // 서비스 모델
                        // console.log('serviceModelid >>', serviceModelId, 'SERVICE_MODEL_TO_TO_NAME >>', this.SERVICE_MODEL_ID_TO_NAME, this.SERVICE_MODEL_ID_TO_NAME[serviceModelId])
                        // serviceModelid >> 1002     SERVICE_MODEL_TO_TO_NAME >> {
                        //     "1": "챗봇",
                        //     "2": "콜봇",
                        //     "22": "추가콜봇",
                        //     "23": "추가챗봇",
                        //     "41": "안서비스",
                        //     "42": "안서비스2",
                        //     "43": "안서비스3",
                        //     "44": "모델4"
                        //   }

                        $($('#update-service-model')[0].parentElement).data('instance').value = this.SERVICE_MODEL_ID_TO_NAME[serviceModelId];
                        self.newObj.serviceModelId = serviceModelId;

                        $($('#update-resultModelId')[0].parentElement).data('instance').value = resultModelId;
                        self.newObj.resultModelId = resultModelId;

                        $($('#update-resultModel-description')[0].parentElement).data('instance').value = this.RESULT_MODEL_ID_TO_DESCRIPTIONS[resultModelId];
                        self.newObj.resultModelDescription = this.RESULT_MODEL_ID_TO_DESCRIPTIONS[resultModelId];

                        $($('#update-resultModel-modeltype')[0].parentElement).data('instance').value = this.RESULT_MODEL_ID_TO_MODELTYPES[resultModelId];
                        self.newObj.resultModelModeltype = this.RESULT_MODEL_ID_TO_MODELTYPES[resultModelId];

                        // 설명
                        $($('#update-description-input')[0].parentElement).data('instance').value = '';
                        this._showValidationHelperLine('', $("#update-description-helper-line"), '설명');

                        self.updateDialog.open();
                        self.currentDialog = 'updateDialog';
                    },
                    convertServiceModelId2Name: function(id) {
                        return this.SERVICE_MODEL_ID_TO_NAME[id];
                    },
                    convertString: function (s) {
                        return s === null ? "" : s;
                    },
                    setDialogLoading: function (loadingBarJqueryEl, option) {
                        if (option == true) {
                            loadingBarJqueryEl.show();
                            return;
                        }
                        loadingBarJqueryEl.hide();
                    },

                    /**
                     * 모달 닫을 때 데이터 요청/전송 취소
                     */
                    onCloseDialog: function () {
                        const self = this;
                        if (self.currentXhr.length !== 0) {
                            if (self.checkXhrAbort && !confirm('취소 시 저장 및 업로드가 중단됩니다.')) return;
                            [...self.currentXhr].forEach(xhrItem => xhrItem.xhr.abort())
                            self.dispatchProcessing('done');
                        }
                        if (self.currentDialog) {
                            self[self.currentDialog].close();
                            self.currentDialog = null;
                        }
                    },

                    /**
                     *
                     * @param state: 'process' || 'done'
                     * 디스패치 시 모달 본문에 유저 동작 방지 적용 및 닫기/취소를 제외한 버튼 비활성화
                     */
                    dispatchProcessing: function (state) {
                        let $modalSurface;
                        let $modalBtn;
                        if (state === 'process') {
                            // 닫기/취소를 제외한 버튼 선택
                            $modalBtn = $('.mdc-dialog--open .mdc-dialog__surface .mdc-button').not('.close-button');
                            // 현재 열려있는 모달 선택
                            $modalSurface = $('.mdc-dialog--open .mdc-dialog__surface');
                            $modalBtn.prop('disabled', true);
                            $modalSurface.addClass('is-processing');
                        } else if (state === 'done') {
                            // 진행 중인 모달 선택.
                            // 모달 닫는게 먼저 실행되면 .mdc-dialog--open으로 선택 불가
                            $modalBtn = $('.mdc-dialog__surface.is-processing .mdc-button').not('.close-button');
                            $modalSurface = $('.mdc-dialog__surface.is-processing');
                            $modalBtn.prop('disabled', false);
                            $modalSurface.removeClass('is-processing');
                        }
                    },
                }
            });
        })();
    </script>
</th:block>

</html>
