<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layouts/nolayout">
<th:block layout:fragment="html">
  <div class="contentRoot">
    <div class="content-header">
      <h2>검증 데이터 관리</h2>
      <div class="button-group">
        <button id="dataAddDialogBtn" class="mdc-button mdc-button--outlined mdc-ripple-upgraded">
          <span class="mdc-button__ripple"></span>
          <i class="material-icons mdc-button__icon">add</i>
          <span class="mdc-button__label">데이터 등록</span>
        </button>
      </div>
    </div>
    <div class="content-body">
      <div class="card">
        <div class="card-header pb-4">
          <div class="form-row md-size multiline-align-top">
            <div id="searchServiceModelSelector" class="mdc-select mdc-select--outlined mdc-select--no-label">
              <div class="mdc-select__anchor">
                <div class="mdc-notched-outline">
                  <span class="mdc-notched-outline__leading"></span>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">서비스모델</label>
                  </div>
                  <span class="mdc-notched-outline__trailing"></span>
                </div>
                <span class="mdc-select__selected-text-container overflow-hidden">
                  <span class="mdc-select__selected-text"></span>
                </span>
                <span class="mdc-select__dropdown-icon"></span>
              </div>
              <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                <ul class="mdc-deprecated-list">
                  <li class="mdc-deprecated-list-item mdc-deprecated-list-item--selected" data-value=" "
                      aria-selected="true">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">전체</span>
                  </li>
                  <li v-for="(item, index) in serviceModelList" class="mdc-deprecated-list-item"
                      :data-value="item.serviceCode">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">{{item.serviceModelName}}</span>
                  </li>
                </ul>
              </div>
            </div>
            <div class="flex-auto flex-ratio-two">
              <div class="form-row h-100">
                <div id="searchRegDtFromInput"
                     class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
                  <i class="material-icons mdc-text-field__icon">event</i>
                  <input type="text" class="mdc-text-field__input"
                         aria-describedby="text-field-outlined-shape-one-helper-text"/>
                  <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                    <div class="mdc-notched-outline__leading"></div>
                    <div class="mdc-notched-outline__notch">
                      <label class="mdc-floating-label">등록일(from)</label>
                    </div>
                    <div class="mdc-notched-outline__trailing"></div>
                  </div>
                </div>
                <div id="searchRegDtToInput"
                     class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
                  <i class="material-icons mdc-text-field__icon">event</i>
                  <input type="text" class="mdc-text-field__input"
                         aria-describedby="text-field-outlined-shape-one-helper-text"/>
                  <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                    <div class="mdc-notched-outline__leading"></div>
                    <div class="mdc-notched-outline__notch">
                      <label class="mdc-floating-label">등록일(to)</label>
                    </div>
                    <div class="mdc-notched-outline__trailing"></div>
                  </div>
                </div>
              </div>
              <div class="mdc-text-field-helper-line">
                <p
                  class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg">
                  등록일이 없는 경우는 전체 기간을 뜻합니다.
                </p>
              </div>
            </div>
            <div id="searchNameInput" class="mdc-text-field text-field mdc-text-field--outlined flex-auto">
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" v-model="datasetName"
                     @keyup.enter="doSearch"/>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">검증데이터셋</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
            <div id="searchDictatedTextInput" class="mdc-text-field text-field mdc-text-field--outlined flex-auto">
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" v-model="dictatedText"
                     @keyup.enter="doSearch"/>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">전사데이터</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
            <div id="searchRegIdInput" class="mdc-text-field text-field mdc-text-field--outlined flex-auto">
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" v-model="regId"
                     @keyup.enter="doSearch"/>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">작성자</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
            <div id="searchDescriptionInput" class="mdc-text-field text-field mdc-text-field--outlined flex-auto">
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" v-model="description"
                     @keyup.enter="doSearch"/>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">설명</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
            <button class="mdc-button mdc-button--unelevated mdc-ripple-upgraded" @click="doSearch">
              <span class="mdc-button__ripple"></span>
              <i class="material-icons mdc-button__icon">search</i>
              <span class="mdc-button__label">검색</span>
            </button>
          </div>
        </div>
        <div class="card-body">
          <div class="table-controls form-row md-size">
            <div class="table-result-info flex-auto">
              <h4>검색결과 : {{fn.addComma(totalCount)}}</span>건</h4>
            </div>
            <button
              class="mdc-button mdc-button--outlined mdc-ripple-upgraded mdc-theme--error h-90"
              @click="doDelete">
              <span class="mdc-button__ripple"></span>
              <i class="material-icons mdc-button__icon">delete</i>
              <span class="mdc-button__label">선택 삭제</span>
            </button>
            <div id="sizeSelector" class="mdc-select mdc-select--outlined mdc-select--no-label">
              <div class="mdc-select__anchor">
                <div class="mdc-notched-outline">
                  <span class="mdc-notched-outline__leading"></span>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">레코드 수</label>
                  </div>
                  <span class="mdc-notched-outline__trailing"></span>
                </div>
                <span class="mdc-select__selected-text-container overflow-hidden">
                  <span class="mdc-select__selected-text"></span>
                </span>
                <span class="mdc-select__dropdown-icon"></span>
              </div>
              <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                <ul class="mdc-deprecated-list">
                  <li class="mdc-deprecated-list-item mdc-deprecated-list-item--selected"
                      data-value="10" aria-selected="true" @click="size=10;">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">10개</span>
                  </li>
                  <li class="mdc-deprecated-list-item" data-value="20" @click="size=20;">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">20개</span>
                  </li>
                  <li class="mdc-deprecated-list-item " data-value="30" @click="size=30;">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">30개</span>
                  </li>
                  <li class="mdc-deprecated-list-item " data-value="40" @click="size=40;">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">40개</span>
                  </li>
                  <li class="mdc-deprecated-list-item " data-value="50" @click="size=50;">
                    <span class="mdc-deprecated-list-item__ripple"></span>
                    <span class="mdc-deprecated-list-item__text">50개</span>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="table-container">
            <div class="mdc-data-table-wrapper">
              <!-- loading bar -->
              <div id="dataListLoadingBar" role="progressbar"
                   class="mdc-linear-progress mdc-linear-progress--indeterminate" style="opacity: 1;">
                <div class="mdc-linear-progress__buffering-dots"></div>
                <div class="mdc-linear-progress__buffer"></div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                  <span class="mdc-linear-progress__bar-inner"></span>
                </div>
                <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                  <span class="mdc-linear-progress__bar-inner"></span>
                </div>
              </div>
              <div class="mdc-data-table">
                <div class="mdc-data-table__table-container">
                  <table class="mdc-data-table__table">
                    <thead>
                    <tr class="mdc-data-table__header-row">
                      <th class="mdc-data-table__header-cell mdc-data-table__header-cell--checkbox text-center"
                          role="columnheader" scope="col">
                        <div
                          class="mdc-checkbox mdc-data-table__header-row-checkbox mdc-checkbox--upgraded mdc-checkbox--selected mdc-ripple-upgraded mdc-ripple-upgraded--unbounded">
                          <input id="chk-all" type="checkbox"
                                 class="mdc-checkbox__native-control"
                                 aria-checked="mixed"/>
                          <div class="mdc-checkbox__background">
                            <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">
                              <path class="mdc-checkbox__checkmark-path" fill="none"
                                    d="M1.73,12.91 8.1,19.28 22.79,4.59"></path>
                            </svg>
                            <div class="mdc-checkbox__mixedmark"></div>
                          </div>
                          <div class="mdc-checkbox__ripple"></div>
                        </div>
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">No.
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">서비스모델
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">검증데이터셋
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">음원파일명
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">전사데이터
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">작성자
                      </th>
                      <th class="mdc-data-table__header-cell text-center" role="columnheader"
                          scope="col">등록일시
                      </th>
                    </tr>
                    </thead>
                    <tbody class="mdc-data-table__content" v-if="0 == currentList.length">
                    <tr class="mdc-data-table__row" aria-selected="false">
                      <td class="text-center" colspan="8">검색 결과가 없습니다.</td>
                    </tr>
                    </tbody>
                    <tbody class="mdc-data-table__content" v-if="0 < currentList.length">
                    <tr v-for="(item, idx) in currentList" :data-id="item.id"
                        class="data-info-row mdc-data-table__row" aria-selected="false"
                        style="cursor: pointer;">
                      <td class="mdc-data-table__cell mdc-data-table__cell--checkbox">
                        <div
                          class="mdc-checkbox mdc-data-table__row-checkbox mdc-checkbox--upgraded mdc-ripple-upgraded mdc-ripple-upgraded--unbounded">
                          <input type="checkbox" class="mdc-checkbox__native-control chk-row"
                                 aria-labelledby="u60" :value="item.id"/>
                          <div class="mdc-checkbox__background">
                            <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">
                              <path class="mdc-checkbox__checkmark-path" fill="none"
                                    d="M1.73,12.91 8.1,19.28 22.79,4.59"></path>
                            </svg>
                            <div class="mdc-checkbox__mixedmark"></div>
                          </div>
                          <div class="mdc-checkbox__ripple"></div>
                        </div>
                      </td>
                      <td class="mdc-data-table__cell text-center">{{itemFromNum - idx}}</td>
                      <td class="mdc-data-table__cell text-center">{{item.serviceModelName}}</td>
                      <td class="mdc-data-table__cell">{{item.datasetName}}</td>
                      <td class="mdc-data-table__cell text-center">{{item.wavFileName}}</td>
                      <td class="mdc-data-table__cell">{{item.dictatedText}}</td>
                      <td class="mdc-data-table__cell text-center">{{item.regId}}</td>
                      <td class="mdc-data-table__cell text-center">
                        {{moment(item.regDt).format("YYYY-MM-DD HH:mm:ss")}}
                      </td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="table-pagination mdc-data-table__pagination" v-if="0 < currentList.length">
            <div class="mdc-data-table__pagination-trailing mdc-chip-set mdc-chip-set--choice">
              <div class="mdc-data-table__pagination-navigation">
                <button class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                        data-first-page="true" v-bind:disabled="!(1 < currentPageNum)" @click="goPage(1)">
                  <div class="mdc-button__icon">first_page</div>
                </button>
                <button class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                        data-prev-page="true" v-bind:disabled="!(1 < currentPageNum)"
                        @click="goPage(Math.max(1, currentPageNum-1))">
                  <div class="mdc-button__icon">chevron_left</div>
                </button>
                <button v-for="page in pagingNumbers"
                        class="mdc-chip mdc-data-table__pagination-button fs-6 bg-transparent"
                        :class="{'mdc-chip--selected': currentPageNum==page}" @click="goPage(page)">
                  {{page}}
                </button>
                <button class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                        data-next-page="true" v-bind:disabled="!(currentPageNum < lastPageNum)"
                        @click="goPage(Math.min(currentPageNum+1, lastPageNum))">
                  <div class="mdc-button__icon">chevron_right</div>
                </button>
                <button class="mdc-icon-button material-icons mdc-data-table__pagination-button fs-6"
                        data-last-page="true" v-bind:disabled="!(currentPageNum < lastPageNum)"
                        @click="goPage(lastPageNum)">
                  <div class="mdc-button__icon">last_page</div>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="dataAddDialog" class="mdc-dialog" role="alertdialog" aria-modal="true" aria-labelledby="simple-dialog-label"
       aria-describedby="simple-dialog-description" tabindex="-1">
    <div class="mdc-dialog__scrim"></div>
    <div class="mdc-dialog__container">
      <div class="mdc-dialog__surface">
        <div class="mdc-dialog__header">
          <h2 class="mdc-dialog__title">검증데이터 등록</h2>
          <button class="mdc-icon-button material-icons close-button" tabindex="-1">
            close
          </button>
        </div>
        <!-- loading bar -->
        <div id="dataAddDialogLoadingBar" role="progressbar"
             class="mdc-linear-progress mdc-linear-progress--indeterminate" style="opacity: 1;">
          <div class="mdc-linear-progress__buffering-dots"></div>
          <div class="mdc-linear-progress__buffer"></div>
          <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
            <span class="mdc-linear-progress__bar-inner"></span>
          </div>
          <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
            <span class="mdc-linear-progress__bar-inner"></span>
          </div>
        </div>
        <section class="mdc-dialog__content form-row-stack">
          <p class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-theme--error">
            *모든 항목은 필수입력사항입니다.</br>
            음원파일은 wav폴더를 압축 해주세요.
          </p>
          <div class="form-row">
            <div id="newDataServiceModelSelector"
                 class="mdc-select mdc-select--outlined mdc-select--no-label flex-auto">
              <div class="mdc-select__anchor" required>
                <div class="mdc-notched-outline">
                  <span class="mdc-notched-outline__leading"></span>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">서비스모델</label>
                  </div>
                  <span class="mdc-notched-outline__trailing"></span>
                </div>
                <span class="mdc-select__selected-text-container overflow-hidden">
                  <span class="mdc-select__selected-text"></span>
                </span>
                <span class="mdc-select__dropdown-icon"></span>
              </div>
              <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                <ul class="mdc-deprecated-list"></ul>
              </div>
            </div>
          </div>
          <div class="form-row multiline-align-top">
            <div class="flex-auto">
              <div id="newDatasetNameInput"
                   class="mdc-text-field text-field mdc-text-field--outlined w-100 lg-size">
                <input type="text" class="mdc-text-field__input"
                       aria-describedby="text-field-outlined-shape-one-helper-text" required/>
                <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                  <div class="mdc-notched-outline__leading"></div>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">데이터셋 이름</label>
                  </div>
                  <div class="mdc-notched-outline__trailing"></div>
                </div>
              </div>
              <div class="mdc-text-field-helper-line">
                <p id="duplicateNewDatasetNameMessage"
                   class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg mdc-theme--success">
                  사용 가능한 데이터셋 이름입니다
                </p>
              </div>
            </div>
            <button id="newDatasetNameCheckBtn"
                    class="mdc-button mdc-button--outlined mdc-ripple-upgraded lg-size">
              <span class="mdc-button__ripple"></span>
              <i class="material-icons mdc-button__icon">content_copy</i>
              <span class="mdc-button__label">중복확인</span>
            </button>
          </div>
          <div class="form-row">
            <div id="newDataBasePathInput" class="mdc-text-field text-field mdc-text-field--outlined w-100">
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" readonly/>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">기본 디렉토리</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
          </div>
          <div class="form-row multiline-align-top">
            <div class="flex-auto">
              <div id="newDetailPathNameInput"
                   class="mdc-text-field text-field mdc-text-field--outlined w-100 lg-size">
                <input type="text" class="mdc-text-field__input"
                       aria-describedby="text-field-outlined-shape-one-helper-text" required/>
                <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                  <div class="mdc-notched-outline__leading"></div>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">상세 디렉토리명</label>
                  </div>
                  <div class="mdc-notched-outline__trailing"></div>
                </div>
              </div>
              <div class="mdc-text-field-helper-line">
                <p id="duplicateNewDetailPathNameMessage"
                   class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg mdc-theme--success">
                  사용 가능한 디렉토리 입니다.
                </p>
              </div>
            </div>
            <button id="newDetailPathNameCheckBtn" class="mdc-button mdc-button--outlined mdc-ripple-upgraded lg-size">
              <span class="mdc-button__ripple"></span>
              <i class="material-icons mdc-button__icon">content_copy</i>
              <span class="mdc-button__label">중복확인</span>
            </button>
          </div>
          <div class="form-row">
            <input type="file" id="answerSheetFileInput" class="d-none" name="file" accept=""/>
            <div id="answerSheetFileNameInput"
                 class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
              <i class="mdc-text-field__icon material-icons">attach_file</i>
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" required/>
              <label for="answerSheetFileInput" class="w-100 h-100 position-absolute"
                     style="z-index: 2; cursor: pointer"></label>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">정답지 파일</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
          </div>
          <div class="form-row">
            <input type="file" id="wavFileInput" class="d-none" name="file" accept=".zip"/>
            <div id="wavFileNameInput"
                 class="mdc-text-field text-field mdc-text-field--outlined mdc-text-field--with-leading-icon w-100">
              <i class="mdc-text-field__icon material-icons">attach_file</i>
              <input type="text" class="mdc-text-field__input"
                     aria-describedby="text-field-outlined-shape-one-helper-text" required/>
              <label for="wavFileInput" class="w-100 h-100 position-absolute"
                     style="z-index: 2; cursor: pointer"></label>
              <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                  <label class="mdc-floating-label">음원 파일(.zip)</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
              </div>
            </div>
          </div>
          <div class="form-row multiline-align-top">
            <div class="flex-auto">
              <div id="newDescriptionInput"
                   class="mdc-text-field text-field mdc-text-field--outlined w-100 lg-size">
                <input type="text" class="mdc-text-field__input"
                       aria-describedby="text-field-outlined-shape-one-helper-text"/>
                <div class="mdc-notched-outline mdc-notched-outline--upgraded">
                  <div class="mdc-notched-outline__leading"></div>
                  <div class="mdc-notched-outline__notch">
                    <label class="mdc-floating-label">설명</label>
                  </div>
                  <div class="mdc-notched-outline__trailing"></div>
                </div>
              </div>
              <div class="mdc-text-field-helper-line">
                <p id="checkNewDescriptionNameMessage"
                   class="mdc-text-field-helper-text mdc-text-field-helper-text--persistent mdc-text-field-helper-text--validation-msg mdc-theme--success">
                  사용 가능한 설명 입니다.
                </p>
              </div>
            </div>
          </div>
          <!--
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell&#45;&#45;span-5 mdc-form-field">
              <label class="mdc-button mdc-button&#45;&#45;outlined mdc-ripple-upgraded w-100 h-100" for="answerSheetFileInput">
                  <input id="answerSheetFileInput" type="file" class="d-none" accept=".txt">
                  <span class="mdc-button__ripple"></span>
                  <i class="material-icons mdc-button__icon me-1">upload</i>
                  <span class="mdc-button__label">정답지 업로드</span>
              </label>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell&#45;&#45;span-7">
              <div id="answerSheetFileNameInput" class="mdc-text-field text-field mdc-text-field&#45;&#45;outlined w-100" readonly>
                  <input type="text" class="mdc-text-field__input" aria-describedby="text-field-outlined-shape-one-helper-text"/>
                  <div class="mdc-notched-outline mdc-notched-outline&#45;&#45;upgraded">
                      <div class="mdc-notched-outline__leading"></div>
                      <div class="mdc-notched-outline__notch">
                          <label class="mdc-floating-label" >파일명</label>
                      </div>
                      <div class="mdc-notched-outline__trailing"></div>
                  </div>
              </div>
          </div>
          -->
          <!--<div class="mdc-layout-grid__cell mdc-layout-grid__cell&#45;&#45;span-5 mdc-form-field">
              <label class="mdc-button mdc-button&#45;&#45;outlined mdc-ripple-upgraded w-100 h-100" for="wavFileInput">
                  <input id="wavFileInput" type="file" class="d-none" accept=".zip">
                  <span class="mdc-button__ripple"></span>
                  <i class="material-icons mdc-button__icon me-1">upload</i>
                  <span class="mdc-button__label">음원파일 업로드</span>
              </label>
          </div>
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell&#45;&#45;span-7">
              <div id="wavFileNameInput" class="mdc-text-field text-field mdc-text-field&#45;&#45;outlined w-100" readonly>
                  <input type="text" class="mdc-text-field__input" aria-describedby="text-field-outlined-shape-one-helper-text"/>
                  <div class="mdc-notched-outline mdc-notched-outline&#45;&#45;upgraded">
                      <div class="mdc-notched-outline__leading"></div>
                      <div class="mdc-notched-outline__notch">
                          <label class="mdc-floating-label" >파일명</label>
                      </div>
                      <div class="mdc-notched-outline__trailing"></div>
                  </div>
              </div>
          </div>-->
        </section>
        <footer class="mdc-dialog__actions">
          <button id="newDataAddBtn" class="mdc-button mdc-button--unelevated mdc-ripple-upgraded">
            <span class="mdc-button__ripple"></span>
            <span class="mdc-button__label">등록</span>
          </button>
          <button
            class="mdc-button mdc-button--unelevated mdc-ripple-upgraded mdc-theme--on-default mdc-theme--default-bg close-button">
            <span class="mdc-button__ripple"></span>
            <span class="mdc-button__label">취소</span>
          </button>
        </footer>
      </div>
    </div>
  </div>
  <input type="hidden" readonly id="smpServiceUriPrefix" th:value="${smpServiceUriPrefix}">
  <input type="hidden" readonly id="defaultPageSize" th:value="${defaultPageSize}">
</th:block>
<th:block layout:fragment="script">
  <script type="text/javascript">
    (function () {

      const DEFAULT_PAGE_START = 0;
      const DEFAULT_PAGE_SIZE = $("#defaultPageSize").val();
      const PAGING_BTN_SIZE = 5;
      const serviceUrlPrefix = $("#smpServiceUriPrefix").val();
      const DETAIL_PAGE_SERVICE_URI = location.origin + serviceUrlPrefix + "/verify/data/{dataId}";
      const LABEL = {
        message: {
          // 공통
          API_ERROR_TITLE: "실패",
          API_ERROR_MESSAGE: "일시적인 오류가 발생하였습니다. 잠시 후 다시 요청해 주세요.<br/><br/>지속적으로 동일한 문제가 발생하는 경우 관리자에게 문의하시기 바랍니다.",
          INVALID_DATASET_NAME_ERROR: "올바른 데이터셋 이름을 입력해 주세요.",
          INVALID_DETAILPATH_NAME_ERROR: "올바른 상세 디렉토리명을 입력해 주세요.",
          INVALID_SERVICEMODEL_ERROR: "서비스모델값을 선택 해주세요.",
          VALID_DATASET_NAME: "사용 가능한 데이터셋 이름 입니다.",
          VALID_DETAILPATH_NAME: "사용 가능한 상세 디렉토리명 입니다.",
          VALID_DESCRIPTION: "사용 가능한 설명 입니다.",
          CONFLICT_DATASET_NAME_ERROR: "이미 등록되어 있거나 올바르지 않은 데이터셋 이름 입니다.",
          CONFLICT_DETAILPATH_NAME_ERROR: "이미 등록되어 있거나 올바르지 않은 상세 디렉토리명 입니다.",
          DATA_ADD_CONFIRM: "신규 데이터를 등록하시겠습니까?",
          DATA_ADD_TITLE: "데이터 등록",
          DATA_ADD_MESSAGE: "신규 데이터가 등록되었습니다.",
          DATA_ADD_FAIL: "데이터 등록에 실패하였습니다. 입력된 정보를 확인 후 다시 등록해 주세요.",
        }
      };
      new Vue({
        el: ".contentRoot",
        data: {
          LABEL: LABEL,
          moment: moment,
          fn: fn,
          serviceUrlPrefix: serviceUrlPrefix,

          //검색조건
          serviceModeId: "",
          regDtFrom: "",
          regDtTo: "",
          datasetName: "",
          dictatedText: "",
          regId: "",
          description : "",
          start: DEFAULT_PAGE_START,
          size: DEFAULT_PAGE_SIZE,

          // 현재 적용되어 있는 검색 조건
          _searchCondition: {
            serviceModelId: "",
            regDtFrom: "",
            regDtTo: "",
            datasetName: "",
            dictatedText: "",
            regId: "",
            description : "",
            start: 0,
            size: 0,
          },

          // 검색 결과
          totalCount: 0,
          currentPageNum: 0,
          lastPageNum: 0,
          itemFromNum: 0,
          itemToNum: 0,
          currentList: [],
          pagingNumbers: [],

          // etc
          initSearched: false,		// 초기 검색이 제공되었는지 여부
          currentXhr: [],	        	// 모달 내 XHR 중단할 때 사용
          checkXhrAbort: false,       // 모달 내에서 등록/저장 등 업로드 시엔 컨펌 추가
          currentDialog: null,        // vue data에서 정의한 모달의 key. ( :string)

          // 그룹 등록 Dialog 변수들
          newDatasetName: "",
          newDataAnswerSheet: "",
          newDataWavFile: "",
          newDataServiceModelId: "",
          newDataBasePath: "",
          basePathVerifyInitData: "/verifyData",
          newDetailPathName: "",
          newDescription: "",

          dataAddDialog: mdc.dialog.MDCDialog.attachTo(document.querySelector('#dataAddDialog')),

          serviceModelList: JSON.parse("[[${serviceModelList}]]".replaceAll('&quot;', "\"")),
          dataList: JSON.parse("[[${dataList}]]".replaceAll('&quot;', "\"")),
          directoryHome: "[[${directoryHome}]]"
        },
        created: function () {
          var self = this;
          this.initPage(location.search.slice(1));
          this.$nextTick(function () {
            self.doRefresh();
          });

          this.initDataAddDialogSelector();
        },
        mounted: function () {
          var self = this;

          // 페이지 이동시 처리
          $('#drawer-main-content-viewer').one('page.move', function () {
            console.log("page move out");
            const $searchRegDtFromInput = $('#searchRegDtFromInput');
            const $searchRegDtToInput = $('#searchRegDtToInput');
            $searchRegDtFromInput.data('datepicker').destroy();
            $searchRegDtToInput.data('datepicker').destroy();
          });

          this.initMaterialUx();

          // 팝업 이외 영역 클릭 시 아무런 처리 하지 않음 default close
          this.dataAddDialog.scrimClickAction = '';

          $('#searchServiceModelSelector').data('select').unlisten('MDCSelect:change')
          $('#searchServiceModelSelector').data('select').listen('MDCSelect:change', function (event) {
            self.serviceModelId = $.trim(event.detail.value);
            // self.doSearch();
          });

          $('#sizeSelector').data('select').unlisten('MDCSelect:change')
          $('#sizeSelector').data('select').listen('MDCSelect:change', function (event) {
            self.size = $.trim(event.detail.value);
            self.doSearch();
          });

          // 데이터셋 등록 요청 팝업
          $('#dataAddDialogBtn').unbind('click').bind('click', function () {
            // 팝업 초기화
            self.showBeforeDataAddDialog($(self.dataAddDialog.root));
            self.dataAddDialog.open();
            self.currentDialog = 'dataAddDialog';
          });

          // 데이터셋 등록 팝업 show 후처리
          this.dataAddDialog.listen('MDCDialog:opened', function () {
            self.showAfterDataAddDialog($(self.dataAddDialog.root));
          });

          // 모달 닫기 및 xhr 종료 이벤트 바인딩
          $('.close-button').off('click').on('click', function () {
            self.onCloseDialog();
          })
          $('.mdc-dialog').on('keydown', function (e) {
            if (e.key === 'Escape') self.onCloseDialog();
          })
        },
        methods: {

          /**
           * 초기 url을 기준으로 화면 내용 설정
           */
          initPage: function (queryString) {
            var params = Qs.parse(queryString);
            this.serviceModelId = params.serviceModeId || "";
            this.regDtFrom = params.regDtFrom || "";
            this.regDtTo = params.regDtTo || "";
            this.datasetName = params.datasetName || "";
            this.dictatedText = params.dictatedText || "";
            this.regId = params.regId || "";
            this.start = parseInt(params.start || DEFAULT_PAGE_START);
            this.size = parseInt(params.size || DEFAULT_PAGE_SIZE);

            this._searchCondition = {
              serviceModelId: this.serviceModelId,
              regDtFrom: this.regDtFrom,
              regDtTo: this.regDtTo,
              datasetName: this.datasetName,
              dictatedText: this.dictatedText,
              regId: this.regId,
              description : this.description,
              start: this.start,
              size: this.size,
            };

            // selector 초기값 설정
            $('#searchServiceModelSelector').attr('data-value', this.serviceModelId);
            $('#sizeSelector').attr('data-value', this.size);
          },

          initMaterialUx: function () {

            // ripple material ux 적용
            const elements = document.querySelectorAll('.mdc-ripple-upgraded');
            for (const el of elements) {
              el.class
              mdc.ripple.MDCRipple.attachTo(el, el.classList.contains('mdc-ripple-upgraded--unbounded') ? {
                isUnbounded: true
              } : void 0);
            }

            // input text material ux 적용
            const textFields = document.querySelectorAll('.mdc-text-field');
            for (const el of textFields) {
              $(el).data('textField', mdc.textField.MDCTextField.attachTo(el));
            }

            // select material ux 적용
            const selects = document.querySelectorAll('.mdc-select');
            for (const el of selects) {
              var $select = mdc.select.MDCSelect.attachTo(el);
              var $el = $(el);
              var value = $el.attr('data-value');
              // 초기값 설정
              _.isEmpty(value) ? $select.setSelectedIndex(0) : $select.setValue(value);
              $el.data('select', $select);
            }

            $("#chk-all").on('click', function () {
              $(".chk-row").prop('checked', $("#chk-all").is(":checked"));
            });
          },

          initDataAddDialogSelector: function () {
            var dataListHtml = this.getDefaultListElement();
            for (var data of this.dataList) {
              dataListHtml += this.getListElement(data.datasetName, data.datasetId);
            }
            console.log(">>  ", this.dataList);
            var serviceModelListHtml = this.getDefaultListElement();
            for (var serviceModel of this.serviceModelList) {

              serviceModelListHtml += this.getListElement(serviceModel.serviceModelName, serviceModel.serviceCode);
            }

            $("#newDataServiceModelSelector ul").html(serviceModelListHtml);

          },

          getListElement: function (text, value) {
            var element = '<li class="mdc-deprecated-list-item" data-value="{value}"><span class="mdc-deprecated-list-item__ripple"></span><span class="mdc-deprecated-list-item__text">{text}</span></li>'
            element = element.replace('{text}', text);
            element = element.replace('{value}', value);

            return element;
          },

          getDefaultListElement: function () {
            return '<li class="mdc-deprecated-list-item mdc-deprecated-list-item--selected" data-value=" " aria-selected="true"><span class="mdc-deprecated-list-item__ripple"></span><span class="mdc-deprecated-list-item__text">선택</span></li>'
          },

          /**
           * 검색 버튼클릭 시 처리
           */
          doSearch: function () {
            let self = this;

            this._searchCondition = {
              serviceModelId: this.serviceModelId,
              regDtFrom: this.regDtFrom,
              regDtTo: this.regDtTo,
              datasetName: this.datasetName,
              dictatedText: this.dictatedText,
              regId: this.regId,
              description : this.description,
              start: 0,
              size: this.size,
            };

            this._pushHistory(this._searchCondition);
            this._search(this._searchCondition, $('#dataListLoadingBar'), function (isError, data) {
              if (isError) {
                toastr.error(data.message, LABEL.message.API_ERROR_TITLE);
              } else {
                self.renderDatas(data.total, data.object, self._searchCondition);
              }
            });
          },

          /**
           * 특정 페이지로 이동한다.
           */
          goPage: function (pageNum) {
            let self = this;

            this._searchCondition.start = this._searchCondition.size * (pageNum - 1);
            this._pushHistory(this._searchCondition);
            this._search(this._searchCondition, $('#dataListLoadingBar'), function (isError, data, total, list) {
              if (isError) {
                toastr.error(data.message, LABEL.message.API_ERROR_TITLE);
              } else {
                self.renderDatas(data.total, data.object, self._searchCondition);
              }
            });
          },

          /**
           * 현재 검색 목록을 refresh한다.
           */
          doRefresh: function () {
            let self = this;
            this._search(this._searchCondition, $('#dataListLoadingBar'), function (isError, data, total, list) {
              if (isError) {
                toastr.error(data.message, LABEL.message.API_ERROR_TITLE);
              } else {
                self.renderDatas(data.total, data.object, self._searchCondition);
              }
            });
          },

          /**
           * 검색결과를 화면에 연결된 변수들에 저장
           */
          renderDatas: function (totalCount, list, condition) {

            $("input[type=checkbox]").prop('checked', false);

            var self = this;
            this.lastPageNum = Math.ceil((totalCount || 0) / condition.size);
            this.currentPageNum = Math.ceil(condition.start / condition.size) + 1;

            this.totalCount = totalCount;
            this.currentList = list || [];
            // 최신순으로 정렬하기 때문에 역순
            this.itemFromNum = totalCount - parseInt(condition.start);
            this.itemToNum = totalCount - Math.min(totalCount, parseInt(condition.start) + parseInt(condition.size));

            this.pagingNumbers = [this.currentPageNum];
            for (let diff = 1; this.pagingNumbers.length < PAGING_BTN_SIZE && diff <= PAGING_BTN_SIZE; diff++) {
              if (1 <= this.currentPageNum - diff) {
                this.pagingNumbers.push(this.currentPageNum - diff);
              }
              if (this.pagingNumbers.length < PAGING_BTN_SIZE && this.currentPageNum + diff <= this.lastPageNum) {
                this.pagingNumbers.push(this.currentPageNum + diff);
              }
            }
            this.pagingNumbers = _.sortBy(this.pagingNumbers);

            this.initDatepicker();

            // 화면에 리스트가 구성된 이후 각 row에 대한 클릭 이벤트 적용
            this.$nextTick(function () {
              $(".chk-row").unbind('click').bind('click', function (ev) {
                ev.stopPropagation();
              });

              $('.data-info-row').unbind('click').bind('click', function (ev) {
                var dataId = ev.currentTarget.dataset.id;
                window.index.movePage(DETAIL_PAGE_SERVICE_URI.replace("{dataId}", dataId));
              });
            });
          },

          initDatepicker: function () {

            var self = this;
            var $searchRegDtFromInput = $('#searchRegDtFromInput');
            var $searchRegDtToInput = $('#searchRegDtToInput');

            // MaterialDatepicker 설정
            var datepickerOption = {
              lang: "en",		// ko 는 없음....
              orientation: "portrait",
              color: document.defaultView.getComputedStyle(document.documentElement).getPropertyValue("--mdc-theme-primary"),
              closeAfterClick: false,
              //date: null,
              outputFormat: 'YYYY-MM-DD',
              topHeaderFormat: 'YYYY MM',
              headerFormat: 'Do',
            };

            if ($searchRegDtFromInput.data('datepicker') != null) {
              $searchRegDtFromInput.data('datepicker').destroy();
            }

            $searchRegDtFromInput.data('datepicker', new MaterialDatepicker($searchRegDtFromInput.data('textField').input, $.extend({}, datepickerOption, {
              onChange: function (date) {
                if (!$searchRegDtFromInput.data('textField')) {
                  return;
                }
                if (_.isEmpty($searchRegDtFromInput.data('textField').value)) {
                  self.regDtFrom = null
                } else {
                  self.regDtFrom = moment(date).format("YYYY-MM-DD HH:mm:ss");
                }
              }
            })));

            if ($searchRegDtToInput.data('datepicker') != null) {
              $searchRegDtToInput.data('datepicker').destroy();
            }

            $searchRegDtToInput.data('datepicker', new MaterialDatepicker($searchRegDtToInput.data('textField').input, $.extend({}, datepickerOption, {
              onChange: function (date) {
                if (!$searchRegDtToInput.data('textField')) {
                  return;
                }
                if (_.isEmpty($searchRegDtToInput.data('textField').value)) {
                  self.regDtTo = null
                } else {
                  self.regDtTo = moment(date).format("YYYY-MM-DD HH:mm:ss");
                }
              }
            })));

            $searchRegDtFromInput.data('textField').value = this.regDtFrom ? moment(this.regDtFrom).format("YYYY-MM-DD") : '';
            $searchRegDtToInput.data('textField').value = this.regDtTo ? moment(this.regDtTo).format("YYYY-MM-DD") : '';

          },

          /**
           * 데이터 등록 팝업 초기화
           */
          showBeforeDataAddDialog: function ($root) {

            var self = this;
            var $newDataServiceModelSelector = $root.find("#newDataServiceModelSelector");
            var $newDatasetNameInput = $root.find('#newDatasetNameInput');
            var $newDatasetNameCheckBtn = $root.find('#newDatasetNameCheckBtn');
            var $duplicateNewDatasetNameMessage = $root.find('#duplicateNewDatasetNameMessage');
            var $newDataBasePathInput = $root.find('#newDataBasePathInput');
            var $newDetailPathNameInput = $root.find('#newDetailPathNameInput');
            var $newDetailPathNameCheckBtn = $root.find('#newDetailPathNameCheckBtn');
            var $duplicateNewDetailPathNameMessage = $root.find('#duplicateNewDetailPathNameMessage');
            var $answerSheetFileInput = $root.find('#answerSheetFileInput');
            var $answerSheetFileNameInput = $root.find("#answerSheetFileNameInput");
            var $wavFileInput = $root.find('#wavFileInput');
            var $wavFileNameInput = $root.find('#wavFileNameInput');
            var $newDescriptionInput = $root.find('#newDescriptionInput');
            var $checkNewDescriptionNameMessage = $root.find('#checkNewDescriptionNameMessage');
            var $loadingBar = $root.find('#dataAddDialogLoadingBar');
            var $dataAddBtn = $root.find('#newDataAddBtn');

            // 팝업 출력 내용 초기화 newDataServiceModelId
            $newDataServiceModelSelector.data('select').value = " ";
            $newDatasetNameInput.data('textField').value = "";
            $newDatasetNameCheckBtn.prop('disabled', false);
            $duplicateNewDatasetNameMessage.empty();
            $newDataBasePathInput.data('textField').value = self.directoryHome + self.basePathVerifyInitData;
            $newDetailPathNameInput.data('textField').value = "";
            $newDetailPathNameCheckBtn.prop('disabled', false);
            $duplicateNewDetailPathNameMessage.empty();
            $dataAddBtn.prop('disabled', true);
            $answerSheetFileInput.val('');
            $answerSheetFileNameInput.data('textField').value = "";
            $wavFileInput.val('');
            $wavFileNameInput.data('textField').value = "";
            $newDescriptionInput.data('textField').value = "";
            $checkNewDescriptionNameMessage.empty();

            // input 이 필수값이 없을때 오류 표기되는 것을 초기화 함
            $root.find('.mdc-text-field').removeClass('mdc-text-field--invalid');

            // 팝업 내용 저장 변수 초기화
            this.newDataServiceModelId = "";
            this.newDatasetName = "";
            this.newDataBasePath = self.directoryHome + self.basePathVerifyInitData;
            this.newDetailPathName = "";
            this.newDataAnswerSheet = "";
            this.newDataWavFile = "";
            this.newDescription = "";

            $loadingBar.css('opacity', 0);
          },

          /**
           * 데이터셋 등록 팝업 이벤트 바인딩 & 값 설정
           */
          showAfterDataAddDialog: function ($root) {

            var self = this;
            var $newDataServiceModelSelector = $root.find("#newDataServiceModelSelector");
            var $newDatasetNameInput = $root.find('#newDatasetNameInput');
            var $newDatasetNameCheckBtn = $root.find('#newDatasetNameCheckBtn');
            var $duplicateNewDatasetNameMessage = $root.find('#duplicateNewDatasetNameMessage');
            var $newDataBasePathInput = $root.find('#newDataBasePathInput');
            var $newDetailPathNameInput = $root.find('#newDetailPathNameInput');
            var $newDetailPathNameCheckBtn = $root.find('#newDetailPathNameCheckBtn');
            var $duplicateNewDetailPathNameMessage = $root.find('#duplicateNewDetailPathNameMessage');
            var $answerSheetFileInput = $root.find('#answerSheetFileInput');
            var $answerSheetFileNameInput = $root.find("#answerSheetFileNameInput");
            var $wavFileInput = $root.find('#wavFileInput');
            var $wavFileNameInput = $root.find('#wavFileNameInput');
            var $newDescriptionInput = $root.find('#newDescriptionInput');
            var $checkNewDescriptionNameMessage = $root.find('#checkNewDescriptionNameMessage');
            var $loadingBar = $root.find('#dataAddDialogLoadingBar');
            var $dataAddBtn = $root.find('#newDataAddBtn');

            // 등록 버튼 활성화 처리
            var registrationActiveFunc = function () {
              self.newDataBasePath = self.directoryHome + self.basePathVerifyInitData;
              if (!_.isEmpty(self.newDatasetName) && _.isEqual(self.newDatasetName, $.trim($newDatasetNameInput.data('textField').value)) &&
                !_.isEmpty(self.newDetailPathName) && _.isEqual(self.newDetailPathName, $.trim($newDetailPathNameInput.data('textField').value)) &&
                !_.isEqual(self.newDataServiceModelId, "") && _.isEqual(self.newDataServiceModelId, $.trim($newDataServiceModelSelector.data('select').value)) &&
                !_.isEqual(self.newDataAnswerSheet, "") &&
                !_.isEqual(self.newDataWavFile, "")) {

                $dataAddBtn.prop('disabled', false);
              } else {

                $dataAddBtn.prop('disabled', true);
              }
            };

            $answerSheetFileInput.unbind('change').bind('change', function (ev) {
              self.newDataAnswerSheet = ev.target.files[0];
              $answerSheetFileNameInput.data('textField').value = self.newDataAnswerSheet.name;
              registrationActiveFunc();
            });

            $wavFileInput.unbind('change').bind('change', function (ev) {
              self.newDataWavFile = ev.target.files[0]
              $wavFileNameInput.data('textField').value = self.newDataWavFile.name;
              registrationActiveFunc();
            });

            $newDataServiceModelSelector.data('select').unlisten("MDCSelect:change");
            $newDataServiceModelSelector.data('select').listen('MDCSelect:change', (ev) => {

              self.newDataServiceModelId = $newDataServiceModelSelector.data('select').value;
              registrationActiveFunc();
            });

            // 데이터셋 이름 입력 변경에 따른 처리
            $newDatasetNameInput.unbind('change keydown keyup').bind('change keydown keyup', function () {
              if (self.newDatasetName !== "" && _.isEqual(self.newDatasetName, $.trim($newDatasetNameInput.data('textField').value))) {
                $newDatasetNameCheckBtn.prop('disabled', true);
              } else {
                $newDatasetNameCheckBtn.prop('disabled', false);
              }
              registrationActiveFunc();
            });

            // 상세 디렉토리명 입력 변경에 따른 처리
            $newDetailPathNameInput.unbind('change keydown keyup').bind('change keydown keyup', function (e) {
              var regExp = /[^0-9a-zA-Z]/g;
              if (regExp.test(e.target.value)) {
                e.target.value = e.target.value.replace(regExp, '');
                self.newDetailPathName = e.target.value
              }

              if (self.newDetailPathName !== "" && _.isEqual(self.newDetailPathName, $.trim($newDetailPathNameInput.data('textField').value))) {
                $newDetailPathNameCheckBtn.prop('disabled', true);
              } else {
                $newDetailPathNameCheckBtn.prop('disabled', false);
              }
              registrationActiveFunc();
            });

            // 설명 입력 변경에 따른 처리
            $newDescriptionInput.unbind('change keydown keyup').bind('change keydown keyup', function (e) {

              self.newDescription = e.target.value;

              if (self.newDescription !== "" && _.isEqual(self.newDescription, $.trim($newDescriptionInput.data('textField').value))) {
                $checkNewDescriptionNameMessage.addClass('mdc-theme--success');
                $checkNewDescriptionNameMessage.html(LABEL.message.VALID_DESCRIPTION);

                self.newDescription = $.trim(self.newDescription);
                // console.log(self.newDescription);
              } else {
                $checkNewDescriptionNameMessage.empty();
              }
            });

            // 데이터셋 이름 중복 확인 버튼 처리
            $newDatasetNameCheckBtn.unbind('click').bind('click', function () {
              var newName = $newDatasetNameInput.data('textField').value;

              if ($.trim(newName) === '') {
                $duplicateNewDatasetNameMessage.removeClass('mdc-theme--success');
                $duplicateNewDatasetNameMessage.addClass('mdc-theme--error');
                $duplicateNewDatasetNameMessage.html(LABEL.message.INVALID_DATASET_NAME_ERROR);
              } else {
                _duplicateCheckDatasetName(newName, $loadingBar, function (isError, data) {
                  if (isError) {
                    toastr.error(LABEL.message.API_ERROR_MESSAGE, LABEL.message.API_ERROR_TITLE);
                  } else if (data === 'ACCEPTED') {
                    $duplicateNewDatasetNameMessage.removeClass('mdc-theme--error');
                    $duplicateNewDatasetNameMessage.addClass('mdc-theme--success');
                    $duplicateNewDatasetNameMessage.html(LABEL.message.VALID_DATASET_NAME);
                    self.newDatasetName = $.trim(newName);
                  } else {
                    $duplicateNewDatasetNameMessage.removeClass('mdc-theme--success');
                    $duplicateNewDatasetNameMessage.addClass('mdc-theme--error');
                    $duplicateNewDatasetNameMessage.html(LABEL.message.CONFLICT_DATASET_NAME_ERROR);
                    self.newDatasetName = '';
                  }
                  $newDatasetNameInput.trigger('change');
                });
              }
            });

            // 상세 디렉토리명 중복 확인 버튼 처리
            $newDetailPathNameCheckBtn.unbind('click').bind('click', function () {
              var newPath = $newDetailPathNameInput.data('textField').value;
              var selectedServiceCode = self.newDataServiceModelId;

              if ($.trim(newPath) === '') {
                $duplicateNewDetailPathNameMessage.removeClass('mdc-theme--success');
                $duplicateNewDetailPathNameMessage.addClass('mdc-theme--error');
                $duplicateNewDetailPathNameMessage.html(LABEL.message.INVALID_DETAILPATH_NAME_ERROR);
              } else if (selectedServiceCode == "" || selectedServiceCode == undefined) {
                $duplicateNewDetailPathNameMessage.removeClass('mdc-theme--success');
                $duplicateNewDetailPathNameMessage.addClass('mdc-theme--error');
                $duplicateNewDetailPathNameMessage.html(LABEL.message.INVALID_SERVICEMODEL_ERROR);
              } else {
                _duplicateCheckDetailPathName(selectedServiceCode, newPath, $loadingBar, function (isError, data) {
                  if (isError) {
                    toastr.error(LABEL.message.API_ERROR_MESSAGE, LABEL.message.API_ERROR_TITLE);
                  } else if (data === 'ACCEPTED') {
                    $duplicateNewDetailPathNameMessage.removeClass('mdc-theme--error');
                    $duplicateNewDetailPathNameMessage.addClass('mdc-theme--success');
                    $duplicateNewDetailPathNameMessage.html(LABEL.message.VALID_DETAILPATH_NAME);
                    self.newDetailPathName = $.trim(newPath);
                  } else {
                    $duplicateNewDetailPathNameMessage.removeClass('mdc-theme--success');
                    $duplicateNewDetailPathNameMessage.addClass('mdc-theme--error');
                    $duplicateNewDetailPathNameMessage.html(LABEL.message.CONFLICT_DETAILPATH_NAME_ERROR);
                    self.newDetailPathName = '';
                  }
                  $newDetailPathNameInput.trigger('change');
                });
              }
            });

            var _duplicateCheckDatasetName = function (name, $loadingBar, cbFunc) {
              $loadingBar.css('opacity', 1);
              let apiUrl = serviceUrlPrefix + "/api/verify/data/name/duplicate";
              let xhr = $.ajax({
                method: "GET",
                url: apiUrl,
                dataType: "json",
                data: {
                  encodedName: encodeURIComponent(name)
                },
                success: function (response, textStatus, jqXHR) {
                  if (typeof cbFunc === "function") {
                    cbFunc(response.code !== 200, response.code === 200 ? response.object : response);
                  }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                  if (typeof cbFunc === "function") {
                    cbFunc(true, jqXHR.status + "] " + jqXHR.responseText);
                  }
                },
                complete: function () {
                  $loadingBar.css('opacity', 0);
                  let result = self.currentXhr.find(obj => obj.id === apiUrl);
                  if (result) {
                    let index = self.currentXhr.indexOf(result);
                    self.currentXhr.splice(index, 1);
                  }
                }
              });
              let result = {id: apiUrl, xhr};
              self.currentXhr.push(result);
            };

            var _duplicateCheckDetailPathName = function (id, path, $loadingBar, cbFunc) {
              $loadingBar.css('opacity', 1);
              let apiUrl = serviceUrlPrefix + "/api/verify/data/path/duplicate";
              let xhr = $.ajax({
                method: "GET",
                url: apiUrl,
                dataType: "json",
                data: {
                  path: path,
                  serviceModelId: id
                },
                success: function (response, textStatus, jqXHR) {
                  if (typeof cbFunc === "function") {
                    cbFunc(response.code !== 200, response.code === 200 ? response.object : response);
                  }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                  if (typeof cbFunc === "function") {
                    cbFunc(true, jqXHR.status + "] " + jqXHR.responseText);
                  }
                },
                complete: function () {
                  $loadingBar.css('opacity', 0);
                  let result = self.currentXhr.find(obj => obj.id === apiUrl);
                  if (result) {
                    let index = self.currentXhr.indexOf(result);
                    self.currentXhr.splice(index, 1);
                  }
                }
              });
              let result = {id: apiUrl, xhr};
              self.currentXhr.push(result);
            };

            // 데이터 등록 버튼 처리
            $dataAddBtn.unbind('click').bind('click', function () {
              if (!confirm(LABEL.message.DATA_ADD_CONFIRM)) {
                return;
              }

              self._registerData({
                datasetName: self.newDatasetName,
                serviceModelId: self.newDataServiceModelId,
                basePath: self.basePathVerifyInitData,
                detailPath: self.newDetailPathName,
                answerSheet: self.newDataAnswerSheet,
                wavFile: self.newDataWavFile,
                description : self.newDescription
              }, $loadingBar, function (isError, data) {
                if (isError) {
                  toastr.error(data.message, LABEL.message.API_ERROR_TITLE);
                } else if (data + "" === 'true') {
                  toastr.success(LABEL.message.DATA_ADD_MESSAGE, LABEL.message.DATA_ADD_TITLE);
                  self.dataAddDialog.close();
                  self.doRefresh();
                }
              });
            });
          },

          /**
           * 현재 검색 조건에 대한 history를 push한다.
           */
          _pushHistory: function (condition) {
            if (!this.initSearched) {
              this.initSearched = true;
              // 맨 처음 page의 경우 history를 변경하여 back 시 이전 페이지로 돌아가도록 한다.
              history.replaceState(null, null, "?" + $.param(condition));
            } else {
              history.pushState(null, null, "?" + $.param(condition));
            }
          },

          /**
           * 검색 API 호출
           */
          _search: function (params, $loadingBar, cbFunc) {
            $loadingBar.css('opacity', 1);
            $.ajax({
              method: "GET",
              url: this.serviceUrlPrefix + "/api/verify/data",
              dataType: "json",
              data: params,
              success: function (response, textStatus, jqXHR) {
                if (typeof cbFunc === "function") {
                  cbFunc(response.code !== 200, response.code === 200 ? response : response);
                }
              },
              error: function (jqXHR, textStatus, errorThrown) {
                if (typeof cbFunc === "function") {
                  cbFunc(true, jqXHR.status + "] " + jqXHR.responseText);
                }
              },
              complete: function () {
                $loadingBar.css('opacity', 0);
              }
            });
          },

          /**
           * 신규 데이터를 등록한다.
           */
          _registerData: function (params, $loadingBar, cbFunc) {
            const self = this;
            $loadingBar.css('opacity', 1);

            // console.log(params);

            var formData = new FormData();
            formData.append("serviceModelId", params.serviceModelId);
            formData.append("datasetName", params.datasetName);
            formData.append("basePath", params.basePath);
            formData.append("detailPath", params.detailPath);
            formData.append("answerSheet", params.answerSheet);
            formData.append("wavFile", params.wavFile);
            formData.append("description", params.description);

            this.dispatchProcessing('process');
            this.checkXhrAbort = true;
            let apiUrl = this.serviceUrlPrefix + "/api/verify/data";

            let xhr = $.ajax({
              method: "POST",
              url: apiUrl,
              enctype: 'multipart/form-data',
              processData: false,
              contentType: false,
              dataType: "json",
              data: formData,
              success: function (response, textStatus, jqXHR) {
                if (typeof cbFunc === "function") {
                  cbFunc(response.code !== 200, response.code === 200 ? response.object : response);
                }
              },
              error: function (jqXHR, textStatus, errorThrown) {
                if (typeof cbFunc === "function") {
                  cbFunc(true, jqXHR);
                }
              },
              complete: function () {
                $loadingBar.css('opacity', 0);
                let result = self.currentXhr.find(obj => obj.id === apiUrl);
                if (result) {
                  let index = self.currentXhr.indexOf(result);
                  self.currentXhr.splice(index, 1);
                }
                self.checkXhrAbort = false;
                self.dispatchProcessing('done');
              }
            });
            let result = {id: apiUrl, xhr};
            self.currentXhr.push(result);
          },

          /**
           * 선택한 데이터를 삭제한다.
           */
          doDelete: function () {
            var self = this;
            var checkedList = $(".chk-row:checked");
            var targetIdList = $.map(checkedList, function (item) {
              return item.value;
            });

            console.log("targetIdList : " + targetIdList);

            if (targetIdList.length < 1) {
              alert("삭제할 검증데이터를 선택해주세요");
              return;
            }

            if (!confirm("검증데이터를 삭제하시겠습니까?")) {
              return;
            }

            var params = {
              targetIdList: targetIdList
            };

            $.ajax({
              method: "POST",
              url: this.serviceUrlPrefix + "/api/verify/data/delete",
              contentType: "application/json",
              dataType: "json",
              data: JSON.stringify(params),
              success: function (response, textStatus, jqXHR) {

                if (response.code === 200) {
                  self.doRefresh();
                  toastr.success("검증데이터 삭제가 완료되었습니다.");
                  return;
                }

                toastr.error(response.message);
              },
              error: function (jqXHR, textStatus, errorThrown) {
                toastr.error(LABEL.message.API_ERROR_MESSAGE);
              }
            });
          },
          getServiceModelNameOfDataset: function (datasetId) {

            for (var data of this.dataList) {
              if ($.trim(data.datasetId) === $.trim(datasetId)) {
                return data.serviceModelName;
              }
            }
          },

          /**
           * 모달 닫을 때 데이터 요청/전송 취소
           */
          onCloseDialog: function () {
            const self = this;
            if (self.currentXhr.length !== 0) {
              if (self.checkXhrAbort && !confirm('취소 시 저장 및 업로드가 중단됩니다.')) return;
              [...self.currentXhr].forEach(xhrItem => xhrItem.xhr.abort())
              self.dispatchProcessing('done');
            }
            if (self.currentDialog) {
              self[self.currentDialog].close();
              self.currentDialog = null;
            }
          },

          /**
           *
           * @param state: 'process' || 'done'
           * 디스패치 시 모달 본문에 유저 동작 방지 적용 및 닫기/취소를 제외한 버튼 비활성화
           */
          dispatchProcessing: function (state) {
            let $modalSurface;
            let $modalBtn;
            if (state === 'process') {
              // 닫기/취소를 제외한 버튼 선택
              $modalBtn = $('.mdc-dialog--open .mdc-dialog__surface .mdc-button').not('.close-button');
              // 현재 열려있는 모달 선택
              $modalSurface = $('.mdc-dialog--open .mdc-dialog__surface');
              $modalBtn.prop('disabled', true);
              $modalSurface.addClass('is-processing');
            } else if (state === 'done') {
              // 진행 중인 모달 선택.
              // 모달 닫는게 먼저 실행되면 .mdc-dialog--open으로 선택 불가
              $modalBtn = $('.mdc-dialog__surface.is-processing .mdc-button').not('.close-button');
              $modalSurface = $('.mdc-dialog__surface.is-processing');
              $modalBtn.prop('disabled', false);
              $modalSurface.removeClass('is-processing');
            }
          },
        }
      });
    })();
  </script>
</th:block>
</html>